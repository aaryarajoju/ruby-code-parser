{
  "pull_request": {
    "repo": "expertiza/expertiza",
    "number": 2933,
    "title": "E2500 refactor student teams functionality",
    "author": "sweekar52",
    "url": "https://github.com/expertiza/expertiza/pull/2933",
    "state": "open",
    "merged": false
  },
  "summary": {
    "pr_title": "E2500 refactor student teams functionality",
    "files_analyzed": 97,
    "files_with_violations": 43,
    "total_violations": 149,
    "violations_in_changed_code": 149,
    "violations_by_type": {
      "INFORMATION_EXPERT": 95,
      "LAW_OF_DEMETER": 30,
      "SRP": 7,
      "ENCAPSULATION": 6,
      "DIP": 4,
      "OCP": 1,
      "OVERUSE_CLASS_METHODS": 6
    },
    "high_severity_count": 144,
    "report_mode": "changed_code_only"
  },
  "files_analyzed": 97,
  "total_violations": 149,
  "violations": [
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_assessment360_controller.rb",
      "class": "Assessment360Controller",
      "score": 0.55,
      "reason": "Method `assignment_grade_summary` manipulates external state 6 times vs 5 local accesses.",
      "location": {
        "line": 131
      },
      "context": "def assignment_grade_summary(cp, assignment_id, penalties)\n    user_id = cp.user_id\n    # topic exists if a team signed up for a topic, which can be found via the user and the assignment\n    topic_id = SignedUpTeam.topic_id(assignment_id, user_id)\n    @topics[cp.id][assignment_id] = SignUpTopic.find_by(id: topic_id)\n    # instructor grade is stored in the team model, which is found by finding the user's team for the assignment",
      "confidence": 0.75,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_assessment360_controller.rb",
      "class": "Assessment360Controller",
      "score": 0.6,
      "reason": "Method `insure_existence_of` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 145
      },
      "context": "def insure_existence_of(course_participants, course)\n    if course_participants.empty?\n      flash[:error] = \"There is no course participant in course #{course.name}\"\n      redirect_back fallback_location: root_path\n    end\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_grades_controller.rb",
      "class": "GradesController",
      "score": 0.6,
      "reason": "Method `view_my_scores` contains a call chain of length 3.",
      "location": {
        "line": 58
      },
      "context": "def view_my_scores\n    @participant = AssignmentParticipant.find(params[:id])\n    @team_id = TeamsParticipant.team_id(@participant.parent_id, @participant.user_id)\n    return if redirect_when_disallowed\n\n    @assignment = @participant.assignment",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_invitations_controller.rb",
      "class": "InvitationsController",
      "score": 0.55,
      "reason": "Method `check_team_before_accept` manipulates external state 4 times vs 3 local accesses.",
      "location": {
        "line": 141
      },
      "context": "def check_team_before_accept\n    @inv = Invitation.find(params[:inv_id])\n    # check if the inviter's team is still existing, and have available slot to add the invitee\n    inviter_assignment_team = AssignmentTeam.team(AssignmentParticipant.find_by(user_id: @inv.from_id, parent_id: @inv.assignment_id))\n    if inviter_assignment_team.nil?\n      flash[:error] = 'The team that invited you does not exist anymore.'",
      "confidence": 0.75,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_join_team_requests_controller.rb",
      "class": "JoinTeamRequestsController",
      "score": 0.6,
      "reason": "Method `check_team_status` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 90
      },
      "context": "def check_team_status\n    # check if the advertisement is from a team member and if so disallow requesting invitations\n    team_member = TeamsParticipant.where(['team_id =? and user_id =?', params[:team_id], session[:user][:id]])\n    team = Team.find(params[:team_id])\n    return flash[:error] = 'This team is full.' if team.full?\n    return flash[:error] = 'You are already a member of this team.' unless team_member.empty?",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_join_team_requests_controller.rb",
      "class": "JoinTeamRequestsController",
      "score": 0.6,
      "reason": "Method `respond_after` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 102
      },
      "context": "def respond_after(request)\n    respond_to do |format|\n      format.html\n      format.xml { render xml: request }\n    end\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_lottery_controller.rb",
      "class": "LotteryController",
      "score": 0.9,
      "reason": "Method `create_new_teams_for_bidding_response` manipulates external state 8 times vs 0 local accesses.",
      "location": {
        "line": 85
      },
      "context": "def create_new_teams_for_bidding_response(teams, assignment, users_bidding_info)\n    teams.each do |user_ids|\n      if assignment.auto_assign_mentor\n        new_team = MentoredTeam.create_team_with_users(assignment.id, user_ids)\n      else\n        new_team = AssignmentTeam.create_team_with_users(assignment.id, user_ids)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
      "class": "PairProgrammingController",
      "score": 1.0,
      "reason": "Class exposes 4 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class PairProgrammingController < ApplicationController\n  include AuthorizationHelper\n\n  def action_allowed?\n    current_user_has_student_privileges?\n  end\n\n  def send_invitations",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
      "class": "PairProgrammingController",
      "score": 0.65,
      "reason": "Method `send_invitations` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 8
      },
      "context": "def send_invitations\n    users = TeamsParticipant.where(team_id: params[:team_id])\n    users.each { |user| user.update_attributes(pair_programming_status: \"W\") }\n    TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id).update_attributes(pair_programming_status: \"A\")\n    # ExpertizaLogger.info \"Accepting Invitation #{params[:inv_id]}: #{accepted}\"\n    Team.find(params[:team_id]).update_attributes(pair_programming_request: 1)",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
      "class": "PairProgrammingController",
      "score": 0.6,
      "reason": "Method `accept` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 18
      },
      "context": "def accept\n    user = TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id)\n    user.update_attributes(pair_programming_status: \"A\")\n    flash[:success] = \"Pair Programming Request Accepted Successfully!\"\n    redirect_to view_student_teams_path student_id: params[:student_id]\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
      "class": "PairProgrammingController",
      "score": 0.6,
      "reason": "Method `decline` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 25
      },
      "context": "def decline\n    user = TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id)\n    user.update_attributes(pair_programming_status: \"D\")\n    Team.find(params[:team_id]).update_attributes(pair_programming_request: 0)\n    flash[:success] = \"Pair Programming Request Declined!\"\n    redirect_to view_student_teams_path student_id: params[:student_id]",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
      "class": "PairProgrammingController",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class PairProgrammingController < ApplicationController\n  include AuthorizationHelper\n\n  def action_allowed?\n    current_user_has_student_privileges?\n  end\n\n  def send_invitations",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
      "class": "ParticipantsController",
      "score": 0.6,
      "reason": "Method `get_user_info` contains a call chain of length 3.",
      "location": {
        "line": 205
      },
      "context": "def get_user_info(team_participant, assignment)\n    user = {}\n    user[:name] = team_participant.name\n    user[:fullname] = team_participant.fullname\n    # set by default\n    permission_granted = false",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "get_user_info"
        ],
        "methods_removed": [
          "get_user_info"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
      "class": "ParticipantsController",
      "score": 0.6,
      "reason": "Method `get_signup_topics_for_assignment` contains a call chain of length 3.",
      "location": {
        "line": 221
      },
      "context": "def get_signup_topics_for_assignment(assignment_id, team_info, team_id)\n    signup_topics = SignUpTopic.where('assignment_id = ?', assignment_id)\n    if signup_topics.any?\n      has_topics = true\n      signup_topics.each do |signup_topic|\n        signup_topic.signed_up_teams.each do |signed_up_team|",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "get_user_info"
        ],
        "methods_removed": [
          "get_user_info"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
      "class": "ParticipantsController",
      "score": 0.8,
      "reason": "Method `get_user_info` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 205
      },
      "context": "def get_user_info(team_participant, assignment)\n    user = {}\n    user[:name] = team_participant.name\n    user[:fullname] = team_participant.fullname\n    # set by default\n    permission_granted = false",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "get_user_info"
        ],
        "methods_removed": [
          "get_user_info"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
      "class": "ParticipantsController",
      "score": 0.8,
      "reason": "Method `get_signup_topics_for_assignment` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 221
      },
      "context": "def get_signup_topics_for_assignment(assignment_id, team_info, team_id)\n    signup_topics = SignUpTopic.where('assignment_id = ?', assignment_id)\n    if signup_topics.any?\n      has_topics = true\n      signup_topics.each do |signup_topic|\n        signup_topic.signed_up_teams.each do |signed_up_team|",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "get_user_info"
        ],
        "methods_removed": [
          "get_user_info"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_popup_controller.rb",
      "class": "PopupController",
      "score": 0.65,
      "reason": "Method `team_participants_popup` manipulates external state 25 times vs 22 local accesses.",
      "location": {
        "line": 35
      },
      "context": "def team_participants_popup\n    @ip = session[:ip]\n    @sum = 0\n    @team = Team.find(params[:id])\n    @assignment = Assignment.find(@team.parent_id)\n    @team_participants = TeamsParticipant.where(team_id: params[:id])",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [
          "team_participants_popup"
        ],
        "methods_removed": [
          "team_users_popup"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
      "class": "ReviewMappingController",
      "score": 0.6,
      "reason": "Method `automatic_review_mapping` contains a call chain of length 3.",
      "location": {
        "line": 344
      },
      "context": "def automatic_review_mapping\n    assignment_id = params[:id].to_i\n    assignment = Assignment.find(params[:id])\n    participants = AssignmentParticipant.where(parent_id: params[:id].to_i).to_a.select(&:can_review).shuffle!\n    teams = AssignmentTeam.where(parent_id: params[:id].to_i).to_a.shuffle!\n    max_team_size = Integer(params[:max_team_size]) # Assignment.find(assignment_id).max_team_size",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 10,
        "lines_deleted": 10,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
      "class": "ReviewMappingController",
      "score": 0.6,
      "reason": "Method `peer_review_strategy` contains a call chain of length 3.",
      "location": {
        "line": 515
      },
      "context": "def peer_review_strategy(assignment_id, review_strategy, participants_hash)\n    teams = review_strategy.teams\n    participants = review_strategy.participants\n    num_participants = participants.size\n\n    teams.each_with_index do |team, iterator|",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 10,
        "lines_deleted": 10,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
      "class": "ReviewMappingController",
      "score": 1.0,
      "reason": "Method `add_reviewer` manipulates external state 12 times vs 0 local accesses.",
      "location": {
        "line": 54
      },
      "context": "def add_reviewer\n    assignment = Assignment.find(params[:id])\n    topic_id = params[:topic_id]\n    user_id = User.where(name: params[:user][:name]).first.id\n    # If instructor want to assign one student to review his/her own artifact,\n    # it should be counted as \"self-review\" and we need to make /app/views/submitted_content/_selfreview.html.erb work.",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 10,
        "lines_deleted": 10,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
      "class": "ReviewMappingController",
      "score": 1.0,
      "reason": "Method `automatic_review_mapping` manipulates external state 20 times vs 0 local accesses.",
      "location": {
        "line": 344
      },
      "context": "def automatic_review_mapping\n    assignment_id = params[:id].to_i\n    assignment = Assignment.find(params[:id])\n    participants = AssignmentParticipant.where(parent_id: params[:id].to_i).to_a.select(&:can_review).shuffle!\n    teams = AssignmentTeam.where(parent_id: params[:id].to_i).to_a.shuffle!\n    max_team_size = Integer(params[:max_team_size]) # Assignment.find(assignment_id).max_team_size",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 10,
        "lines_deleted": 10,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
      "class": "ReviewMappingController",
      "score": 1.0,
      "reason": "Method `peer_review_strategy` manipulates external state 40 times vs 0 local accesses.",
      "location": {
        "line": 515
      },
      "context": "def peer_review_strategy(assignment_id, review_strategy, participants_hash)\n    teams = review_strategy.teams\n    participants = review_strategy.participants\n    num_participants = participants.size\n\n    teams.each_with_index do |team, iterator|",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 10,
        "lines_deleted": 10,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
      "class": "SignUpSheetController",
      "score": 0.6,
      "reason": "Method `delete_signup_as_instructor` contains a call chain of length 3.",
      "location": {
        "line": 290
      },
      "context": "def delete_signup_as_instructor\n    # find participant using assignment using team and topic ids\n    team = Team.find(params[:id])\n    assignment = Assignment.find(team.parent_id)\n    user = TeamsParticipant.find_by(team_id: team.id).user\n    participant = AssignmentParticipant.find_by(user_id: user.id, parent_id: assignment.id)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
      "class": "SignUpSheetController",
      "score": 1.0,
      "reason": "Method `delete_signup_as_instructor` manipulates external state 13 times vs 0 local accesses.",
      "location": {
        "line": 290
      },
      "context": "def delete_signup_as_instructor\n    # find participant using assignment using team and topic ids\n    team = Team.find(params[:id])\n    assignment = Assignment.find(team.parent_id)\n    user = TeamsParticipant.find_by(team_id: team.id).user\n    participant = AssignmentParticipant.find_by(user_id: user.id, parent_id: assignment.id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
      "class": "SignUpSheetController",
      "score": 0.85,
      "reason": "Method `switch_original_topic_to_approved_suggested_topic` manipulates external state 7 times vs 0 local accesses.",
      "location": {
        "line": 424
      },
      "context": "def switch_original_topic_to_approved_suggested_topic\n    assignment = AssignmentParticipant.find(params[:id]).assignment\n    team_id = TeamsParticipant.team_id(assignment.id, session[:user].id)\n\n    # Tmp variable to store topic id before change\n    original_topic_id = SignedUpTeam.topic_id(assignment.id.to_i, session[:user].id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
      "class": "StudentTeamsController",
      "score": 0.9,
      "reason": "Method `remove_participant` manipulates external state 8 times vs 0 local accesses.",
      "location": {
        "line": 122
      },
      "context": "def remove_participant\n    # remove the record from teams_participants table\n    team_participant = TeamsParticipant.where(team_id: params[:team_id], user_id: student.user_id)\n    remove_team_participant(team_participant)\n    # if your old team does not have any members, delete the entry for the team\n    if TeamsParticipant.where(team_id: params[:team_id]).empty?",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 8,
        "lines_deleted": 8,
        "methods_added": [
          "remove_team_participant"
        ],
        "methods_removed": [
          "remove_team_user"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
      "class": "StudentTeamsController",
      "score": 0.6,
      "reason": "Method `remove_team_participant` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 143
      },
      "context": "def remove_team_participant(team_participant)\n    return false unless team_participant\n\n    team_participant.destroy_all\n    undo_link \"The user \\\"#{team_participant.name}\\\" has been successfully removed from the team.\"\n    ExpertizaLogger.info LoggerMessage.new(controller_name, session[:user].name, 'User removed a participant from the team', request)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 8,
        "lines_deleted": 8,
        "methods_added": [
          "remove_team_participant"
        ],
        "methods_removed": [
          "remove_team_user"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
      "class": "StudentTeamsController",
      "score": 0.6,
      "reason": "Method `team_created_successfully` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 151
      },
      "context": "def team_created_successfully(current_team = nil)\n    if current_team\n      undo_link \"The team \\\"#{current_team.name}\\\" has been successfully updated.\"\n    else\n      undo_link \"The team \\\"#{team.name}\\\" has been successfully updated.\"\n    end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 8,
        "lines_deleted": 8,
        "methods_added": [
          "remove_team_participant"
        ],
        "methods_removed": [
          "remove_team_user"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_suggestion_controller.rb",
      "class": "SuggestionController",
      "score": 0.7,
      "reason": "Method `send_email` manipulates external state 8 times vs 4 local accesses.",
      "location": {
        "line": 94
      },
      "context": "def send_email\n    proposer = User.find_by(id: @user_id)\n    if proposer\n      teams_participants = TeamsParticipant.where(team_id: @team_id)\n      cc_mail_list = []\n      teams_participants.each do |teams_participant|",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_controller.rb",
      "class": "TeamsController",
      "score": 0.6,
      "reason": "Method `delete_all` contains a call chain of length 3.",
      "location": {
        "line": 115
      },
      "context": "def delete_all\n    root_node = Object.const_get(session[:team_type] + 'Node').find_by(node_object_id: params[:id])\n    child_nodes = root_node.get_teams.map(&:node_object_id)\n    Team.destroy_all if child_nodes\n    redirect_to action: 'list', id: params[:id]\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_controller.rb",
      "class": "TeamsController",
      "score": 0.6,
      "reason": "Method `delete` contains a call chain of length 3.",
      "location": {
        "line": 123
      },
      "context": "def delete\n    # delete records in team, teams_participants, signed_up_teams table\n    @team = Team.find_by(id: params[:id])\n    unless @team.nil?\n      # Find all SignedUpTeam records associated with the found team.\n      @signed_up_team = SignedUpTeam.where(team_id: @team.id)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 4,
        "lines_deleted": 4,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 1.0,
      "reason": "Class exposes 8 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "DIP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 0.75,
      "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
      "location": {
        "line": 1
      },
      "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 0.6,
      "reason": "Method `index` contains a call chain of length 3.",
      "location": {
        "line": 6
      },
      "context": "def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 0.7,
      "reason": "Method `create` contains a call chain of length 4.",
      "location": {
        "line": 17
      },
      "context": "def create\n    user = User.find_by(name: join_params[:user_name])\n    unless user\n      flash.now[:error] = \"No user found with name #{join_params[:user_name].inspect}\"\n      return render :new, status: :unprocessable_entity\n    end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 0.85,
      "reason": "Method `create` manipulates external state 11 times vs 4 local accesses.",
      "location": {
        "line": 17
      },
      "context": "def create\n    user = User.find_by(name: join_params[:user_name])\n    unless user\n      flash.now[:error] = \"No user found with name #{join_params[:user_name].inspect}\"\n      return render :new, status: :unprocessable_entity\n    end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 0.55,
      "reason": "Method `delete_selected` manipulates external state 3 times vs 2 local accesses.",
      "location": {
        "line": 51
      },
      "context": "def delete_selected\n    ids     = Array(params[:selected]).map(&:to_i).uniq\n    deleted = TeamsParticipant.where(id: ids, team_id: @team.id).destroy_all\n    flash[:notice] = \"Removed #{deleted.size} #{'member'.pluralize(deleted.size)}.\"\n    redirect_to team_teams_participants_path(@team)\n  end",
      "confidence": 0.75,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
      "class": "TeamsParticipantsController",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 71,
        "lines_deleted": 0,
        "methods_added": [
          "index",
          "new",
          "create",
          "destroy",
          "delete_selected",
          "set_team",
          "set_member",
          "join_params"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_assignment_helper.rb",
      "class": "AssignmentHelper",
      "score": 0.9,
      "reason": "Method `get_data_for_list_submissions` manipulates external state 9 times vs 1 local accesses.",
      "location": {
        "line": 78
      },
      "context": "def get_data_for_list_submissions(team)\n    teams_participants = TeamsParticipant.where(team_id: team.id)\n    topic = SignedUpTeam.where(team_id: team.id).first.try :topic\n    topic_identifier = topic.try :topic_identifier\n    topic_name = topic.try :topic_name\n    users_for_curr_team = []",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_assignment_helper.rb",
      "class": "AssignmentHelper",
      "score": 0.6,
      "reason": "Method `get_team_name_color_in_list_submission` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 95
      },
      "context": "def get_team_name_color_in_list_submission(team)\n    if team.try(:grade_for_submission) && team.try(:comment_for_submission)\n      '#cd6133' # brown. submission grade has been assigned.\n    else\n      '#0984e3' # submission grade is not assigned yet.\n    end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "DIP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_manage_team_helper.rb",
      "class": "ManageTeamHelper",
      "score": 0.75,
      "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
      "location": {
        "line": 4
      },
      "context": "module ManageTeamHelper\n  # Adds a user specified by 'user' object to a team specified by 'team_id'\n  def create_team_participants(user, team_id)\n    # if user does not exist flash message\n    unless user\n      urlCreate = url_for controller: 'users', action: 'new'\n      ExpertizaLogger.error LoggerMessage.new('ManageTeamHelper', '', 'User being added to the team does not exist!', request)\n      flash[:error] = \"\\\"#{params[:user][:name].strip}\\\" is not defined. Please <a href=\\\"#{urlCreate}\\\">create</a> this user before continuing.\"",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [
          "create_team_participants"
        ],
        "methods_removed": [
          "create_team_users"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_manage_team_helper.rb",
      "class": "ManageTeamHelper",
      "score": 0.6,
      "reason": "Method `create_team_participants` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 6
      },
      "context": "def create_team_participants(user, team_id)\n    # if user does not exist flash message\n    unless user\n      urlCreate = url_for controller: 'users', action: 'new'\n      ExpertizaLogger.error LoggerMessage.new('ManageTeamHelper', '', 'User being added to the team does not exist!', request)\n      flash[:error] = \"\\\"#{params[:user][:name].strip}\\\" is not defined. Please <a href=\\\"#{urlCreate}\\\">create</a> this user before continuing.\"",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [
          "create_team_participants"
        ],
        "methods_removed": [
          "create_team_users"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
      "class": "ReviewMappingHelper",
      "score": 0.6,
      "reason": "Method `get_team_reviewed_link_name` contains a call chain of length 3.",
      "location": {
        "line": 116
      },
      "context": "def get_team_reviewed_link_name(max_team_size, _response, reviewee_id, ip_address)\n    team_reviewed_link_name = if max_team_size == 1\n                                TeamsParticipant.where(team_id: reviewee_id).first.user.fullname(ip_address)\n                              else\n                                # E1991 : check anonymized view here\n                                Team.find(reviewee_id).name",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
      "class": "ReviewMappingHelper",
      "score": 0.6,
      "reason": "Method `link_updated_since_last?` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 109
      },
      "context": "def link_updated_since_last?(round, due_dates, link_updated_at)\n    submission_due_date = due_dates.where(round: round, deadline_type_id: 1).try(:first).try(:due_at)\n    submission_due_last_round = due_dates.where(round: round - 1, deadline_type_id: 1).try(:first).try(:due_at)\n    (link_updated_at < submission_due_date) && (link_updated_at > submission_due_last_round)\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
      "class": "ReviewMappingHelper",
      "score": 0.65,
      "reason": "Method `get_team_reviewed_link_name` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 116
      },
      "context": "def get_team_reviewed_link_name(max_team_size, _response, reviewee_id, ip_address)\n    team_reviewed_link_name = if max_team_size == 1\n                                TeamsParticipant.where(team_id: reviewee_id).first.user.fullname(ip_address)\n                              else\n                                # E1991 : check anonymized view here\n                                Team.find(reviewee_id).name",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
      "class": "ReviewMappingHelper",
      "score": 0.65,
      "reason": "Method `get_css_style_for_calibration_report` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 402
      },
      "context": "def get_css_style_for_calibration_report(diff)\n    # diff - difference between stu's answer and instructor's answer\n    dict = { 0 => 'c5', 1 => 'c4', 2 => 'c3', 3 => 'c2' }\n    css_class = if dict.key?(diff.abs)\n                  dict[diff.abs]\n                else",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
      "class": "SignUpSheetHelper",
      "score": 0.6,
      "reason": "Method `get_intelligent_topic_row` contains a call chain of length 3.",
      "location": {
        "line": 33
      },
      "context": "def get_intelligent_topic_row(topic, selected_topics, max_team_size = 3)\n    row_html = ''\n    if selected_topics.present?\n      selected_topics.each do |selected_topic|\n        row_html = if (selected_topic.topic_id == topic.id) && !selected_topic.is_waitlisted\n                     '<tr bgcolor=\"yellow\">'",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
      "class": "SignUpSheetHelper",
      "score": 0.7,
      "reason": "Method `render_participant_info` contains a call chain of length 4.",
      "location": {
        "line": 59
      },
      "context": "def render_participant_info(topic, assignment, participants)\n    html = ''\n    if participants.present?\n      chooser_present = false\n      participants.each do |participant|\n        next unless topic.id == participant.topic_id",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
      "class": "SignUpSheetHelper",
      "score": 0.55,
      "reason": "Method `get_suggested_topics` manipulates external state 2 times vs 1 local accesses.",
      "location": {
        "line": 22
      },
      "context": "def get_suggested_topics(assignment_id)\n    team_id = TeamsParticipant.team_id(assignment_id, session[:user].id)\n    teams_participants = TeamsParticipant.where(team_id: team_id)\n    teams_participants_array = []\n    teams_participants.each do |teams_participant|\n      teams_participants_array << teams_participant.user_id",
      "confidence": 0.75,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
      "class": "SignUpSheetHelper",
      "score": 1.0,
      "reason": "Method `get_intelligent_topic_row` manipulates external state 11 times vs 0 local accesses.",
      "location": {
        "line": 33
      },
      "context": "def get_intelligent_topic_row(topic, selected_topics, max_team_size = 3)\n    row_html = ''\n    if selected_topics.present?\n      selected_topics.each do |selected_topic|\n        row_html = if (selected_topic.topic_id == topic.id) && !selected_topic.is_waitlisted\n                     '<tr bgcolor=\"yellow\">'",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
      "class": "SignUpSheetHelper",
      "score": 1.0,
      "reason": "Method `render_participant_info` manipulates external state 15 times vs 0 local accesses.",
      "location": {
        "line": 59
      },
      "context": "def render_participant_info(topic, assignment, participants)\n    html = ''\n    if participants.present?\n      chooser_present = false\n      participants.each do |participant|\n        next unless topic.id == participant.topic_id",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.6,
      "reason": "Method `find_participant_emails` contains a call chain of length 3.",
      "location": {
        "line": 61
      },
      "context": "def find_participant_emails\n    emails = []\n    participants = Participant.where(parent_id: assignment_id)\n    participants.each do |participant|\n      emails << participant.user.email unless participant.user.nil?\n    end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.6,
      "reason": "Method `drop_one_member_topics` contains a call chain of length 3.",
      "location": {
        "line": 70
      },
      "context": "def drop_one_member_topics\n    teams = TeamsParticipant.all.group(:team_id).count(:team_id)\n    teams.keys.each do |team_id|\n      if teams[team_id] == 1\n        topic_to_drop = SignedUpTeam.where(team_id: team_id).first\n        topic_to_drop.delete if topic_to_drop # check if the one-person-team has signed up a topic",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.6,
      "reason": "Method `drop_outstanding_reviews` contains a call chain of length 3.",
      "location": {
        "line": 80
      },
      "context": "def drop_outstanding_reviews\n    reviews = ResponseMap.where(reviewed_object_id: assignment_id)\n    reviews.each do |review|\n      review_has_began = Response.where(map_id: review.id)\n      if review_has_began.size.zero?\n        review_to_drop = ResponseMap.where(id: review.id)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.65,
      "reason": "Method `find_participant_emails` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 61
      },
      "context": "def find_participant_emails\n    emails = []\n    participants = Participant.where(parent_id: assignment_id)\n    participants.each do |participant|\n      emails << participant.user.email unless participant.user.nil?\n    end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.65,
      "reason": "Method `drop_one_member_topics` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 70
      },
      "context": "def drop_one_member_topics\n    teams = TeamsParticipant.all.group(:team_id).count(:team_id)\n    teams.keys.each do |team_id|\n      if teams[team_id] == 1\n        topic_to_drop = SignedUpTeam.where(team_id: team_id).first\n        topic_to_drop.delete if topic_to_drop # check if the one-person-team has signed up a topic",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
      "class": "MailWorker",
      "score": 0.75,
      "reason": "Method `drop_outstanding_reviews` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 80
      },
      "context": "def drop_outstanding_reviews\n    reviews = ResponseMap.where(reviewed_object_id: assignment_id)\n    reviews.each do |review|\n      review_has_began = Response.where(map_id: review.id)\n      if review_has_began.size.zero?\n        review_to_drop = ResponseMap.where(id: review.id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
      "class": "Assignment",
      "score": 0.6,
      "reason": "Method `remove_empty_teams` contains a call chain of length 3.",
      "location": {
        "line": 102
      },
      "context": "def remove_empty_teams\n    empty_teams = teams.reload.select { |team| team.teams_participants.empty? }\n    teams.delete(empty_teams)\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
      "class": "Assignment",
      "score": 0.65,
      "reason": "Method `remove_empty_teams` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 102
      },
      "context": "def remove_empty_teams\n    empty_teams = teams.reload.select { |team| team.teams_participants.empty? }\n    teams.delete(empty_teams)\n  end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
      "class": "Assignment",
      "score": 0.65,
      "reason": "Method `valid_num_review` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 108
      },
      "context": "def valid_num_review\n    self.num_reviews = num_reviews_allowed\n    if num_reviews_greater?(num_reviews_required, num_reviews_allowed)\n      errors.add(:message, 'Num of reviews required cannot be greater than number of reviews allowed')\n    elsif num_reviews_greater?(num_metareviews_required, num_metareviews_allowed)\n      errors.add(:message, 'Number of Meta-Reviews required cannot be greater than number of meta-reviews allowed')",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_participant.rb",
      "class": "AssignmentParticipant",
      "score": 0.6,
      "reason": "Method `review_file_path` contains a call chain of length 3.",
      "location": {
        "line": 171
      },
      "context": "def review_file_path(response_map_id = nil, participant = nil)\n    if response_map_id.nil?\n      return if participant.nil?\n\n      no_team_path = assignment.path + '/' + participant.name.parameterize(separator: '_') + '_review'\n      return no_team_path if participant.team.nil?",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "team_participant"
        ],
        "methods_removed": [
          "team_user"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_participant.rb",
      "class": "AssignmentParticipant",
      "score": 1.0,
      "reason": "Method `review_file_path` manipulates external state 12 times vs 0 local accesses.",
      "location": {
        "line": 171
      },
      "context": "def review_file_path(response_map_id = nil, participant = nil)\n    if response_map_id.nil?\n      return if participant.nil?\n\n      no_team_path = assignment.path + '/' + participant.name.parameterize(separator: '_') + '_review'\n      return no_team_path if participant.team.nil?",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [
          "team_participant"
        ],
        "methods_removed": [
          "team_user"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
      "class": "AssignmentTeam",
      "score": 0.9,
      "reason": "Method `team` manipulates external state 8 times vs 0 local accesses.",
      "location": {
        "line": 212
      },
      "context": "def self.team(participant)\n    return nil if participant.nil?\n\n    team = nil\n    teams_participants = TeamsParticipant.where(user_id: participant.user_id)\n    return nil unless teams_participants",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
      "class": "AssignmentTeam",
      "score": 0.7,
      "reason": "Method `export_fields` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 230
      },
      "context": "def self.export_fields(options)\n    fields = []\n    fields.push('Team Name')\n    fields.push('Team members') if options[:team_name] == 'false'\n    fields.push('Assignment Name')\n  end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
      "class": "AssignmentTeam",
      "score": 0.7,
      "reason": "Method `create_new_team` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 283
      },
      "context": "def create_new_team(user_id, signuptopic)\n    t_user = TeamsParticipant.create(team_id: id, user_id: user_id)\n    SignedUpTeam.create(topic_id: signuptopic.id, team_id: id, is_waitlisted: 0)\n    parent = TeamNode.create(parent_id: signuptopic.assignment_id, node_object_id: id)\n    TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)\n  end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
      "class": "Cake",
      "score": 0.6,
      "reason": "Method `calculate_total_score` contains a call chain of length 3.",
      "location": {
        "line": 116
      },
      "context": "def calculate_total_score(question_answers)\n    question_score = 0.0\n    question_answers.each do |question_answer|\n      # calculate score per question\n      unless question_answer.answer.nil?\n        question_score += question_answer.answer",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
      "class": "Cake",
      "score": 0.7,
      "reason": "Method `get_total_score_for_question` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 96
      },
      "context": "def get_total_score_for_question(review_type, question_id, participant_id, assignment_id, reviewee_id)\n    # get the reviewer's team id for the currently answered question\n    team_id = Team.joins([:teams_participants, teams_participants: [{ user: :participants }]]).where('participants.id = ? and teams.parent_id in (?)', participant_id, assignment_id).first\n    team_id = team_id.id if team_id\n    if review_type == 'TeammateReviewResponseMap'\n      answers_for_team_members = get_answers_for_teammatereview(team_id, question_id, participant_id, assignment_id, reviewee_id)",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
      "class": "Cake",
      "score": 0.85,
      "reason": "Method `get_answers_for_teammatereview` manipulates external state 7 times vs 0 local accesses.",
      "location": {
        "line": 107
      },
      "context": "def get_answers_for_teammatereview(team_id, question_id, participant_id, assignment_id, reviewee_id)\n    # get the reviewer's team members for the currently answered question\n    team_members = Participant.joins(user: :teams_participants).where('teams_participants.team_id in (?) and participants.parent_id in (?)', team_id, assignment_id).ids\n    # get the reviewer's ratings for his team members\n    Answer.joins([{ response: :response_map }, :question]).where(\"response_maps.reviewee_id in (?) and response_maps.reviewed_object_id = (?)\n      and answer is not null and response_maps.reviewer_id in (?) and answers.question_id in (?) and response_maps.reviewee_id not in (?)\", team_members, assignment_id, participant_id, question_id, reviewee_id).to_a",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
      "class": "Cake",
      "score": 0.65,
      "reason": "Method `calculate_total_score` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 116
      },
      "context": "def calculate_total_score(question_answers)\n    question_score = 0.0\n    question_answers.each do |question_answer|\n      # calculate score per question\n      unless question_answer.answer.nil?\n        question_score += question_answer.answer",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_course_team.rb",
      "class": "CourseTeam",
      "score": 0.7,
      "reason": "Method `add_member` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 70
      },
      "context": "def add_member(user, _id = nil)\n    raise \"The user \\\"#{user.name}\\\" is already a member of the team, \\\"#{name}\\\"\" if user?(user)\n\n    t_user = TeamsParticipant.create(user_id: user.id, team_id: id)\n    parent = TeamNode.find_by(node_object_id: id)\n    TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
      "class": "Invitation",
      "score": 0.6,
      "reason": "Method `remove_users_sent_invites_for_assignment` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 20
      },
      "context": "def self.remove_users_sent_invites_for_assignment(user_id, assignment_id)\n    invites = Invitation.where('from_id = ? and assignment_id = ?', user_id, assignment_id)\n    invites.each(&:destroy)\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 12,
        "lines_deleted": 12,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
      "class": "Invitation",
      "score": 0.6,
      "reason": "Method `update_users_topic_after_invite_accept` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 26
      },
      "context": "def self.update_users_topic_after_invite_accept(invitee_user_id, invited_user_id, assignment_id)\n    new_team_id = TeamsParticipant.team_id(assignment_id, invitee_user_id)\n    # check the invited_user_id have ever join other team in this assignment before\n    # if so, update the original record; else create a new record\n    original_team_id = TeamsParticipant.team_id(assignment_id, invited_user_id)\n    if original_team_id",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 12,
        "lines_deleted": 12,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
      "class": "Invitation",
      "score": 0.55,
      "reason": "Method `accept_invitation` manipulates external state 2 times vs 1 local accesses.",
      "location": {
        "line": 45
      },
      "context": "def self.accept_invitation(team_id, inviter_user_id, invited_user_id, assignment_id)\n    # if you are on a team and you accept another invitation and if your old team does not have any members, delete the entry for the team\n    if TeamsParticipant.team_empty?(team_id) && (team_id != '0')\n      assignment_id = AssignmentTeam.find(team_id).assignment.id\n      # Release topics for the team has selected by the invited users empty team\n      SignedUpTeam.release_topics_selected_by_team_for_assignment(team_id, assignment_id)",
      "confidence": 0.75,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 12,
        "lines_deleted": 12,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
      "class": "Invitation",
      "score": 0.6,
      "reason": "Method `is_invited?` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 68
      },
      "context": "def self.is_invited?(invitee_user_id, invited_user_id, assignment_id)\n    sent_invitation = Invitation.where('from_id = ? and to_id = ? and assignment_id = ? and reply_status = \"W\"',\n                                       invitee_user_id, invited_user_id, assignment_id)\n    sent_invitation.empty?\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 12,
        "lines_deleted": 12,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
      "class": "MentorManagement",
      "score": 0.6,
      "reason": "Method `assign_mentor` contains a call chain of length 3.",
      "location": {
        "line": 43
      },
      "context": "def self.assign_mentor(assignment_id, team_id)\n    assignment = Assignment.find(assignment_id)\n    team = Team.find(team_id)\n\n    # RuboCop 'use guard clause instead of nested conditionals'\n    # return if assignments can't accept mentors",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
      "class": "MentorManagement",
      "score": 0.9,
      "reason": "Method `assign_mentor` manipulates external state 8 times vs 0 local accesses.",
      "location": {
        "line": 43
      },
      "context": "def self.assign_mentor(assignment_id, team_id)\n    assignment = Assignment.find(assignment_id)\n    team = Team.find(team_id)\n\n    # RuboCop 'use guard clause instead of nested conditionals'\n    # return if assignments can't accept mentors",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
      "class": "MentorManagement",
      "score": 0.75,
      "reason": "Method `zip_mentors_with_team_count` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 124
      },
      "context": "def self.zip_mentors_with_team_count(assignment_id)\n    mentor_ids = mentors_for_assignment(assignment_id).pluck(:user_id)\n    return [] if mentor_ids.empty?\n    team_counts = {}\n    mentor_ids.each { |id| team_counts[id] = 0 }\n    #E2351 removed (:team_id) after .count to fix balancing algorithm",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "DIP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
      "class": "MentoredTeam",
      "score": 0.75,
      "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
      "location": {
        "line": 1
      },
      "context": "class MentoredTeam < AssignmentTeam\n    # Class created during refactoring of E2351\n    # Overridden method to include the MentorManagement workflow\n    def add_member(user, _assignment_id = nil)\n        raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n    \n        can_add_member = false\n        unless full?",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
      "class": "MentoredTeam",
      "score": 0.7,
      "reason": "Method `import_team_members` contains a call chain of length 4.",
      "location": {
        "line": 22
      },
      "context": "def import_team_members(row_hash)\n        row_hash[:teammembers].each_with_index do |teammate, _index|\n          if teammate.to_s.strip.empty?\n            next\n          end\n          user = User.find_by(name: teammate.to_s)",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
      "class": "MentoredTeam",
      "score": 0.75,
      "reason": "Method `add_member` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 4
      },
      "context": "def add_member(user, _assignment_id = nil)\n        raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n    \n        can_add_member = false\n        unless full?\n          can_add_member = true",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
      "class": "MentoredTeam",
      "score": 0.75,
      "reason": "Method `import_team_members` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 22
      },
      "context": "def import_team_members(row_hash)\n        row_hash[:teammembers].each_with_index do |teammate, _index|\n          if teammate.to_s.strip.empty?\n            next\n          end\n          user = User.find_by(name: teammate.to_s)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
      "class": "Participant",
      "score": 0.6,
      "reason": "Method `force_delete` contains a call chain of length 3.",
      "location": {
        "line": 58
      },
      "context": "def force_delete(maps)\n    maps && maps.each(&:destroy)\n    if team && (team.teams_participants.length == 1)\n      team.delete\n    elsif team\n      team.teams_participants.each { |teams_participant| teams_participant.destroy if teams_participant.user_id == id }",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
      "class": "Participant",
      "score": 0.6,
      "reason": "Method `topic_name` contains a call chain of length 3.",
      "location": {
        "line": 68
      },
      "context": "def topic_name\n    if topic.nil? || topic.topic_name.empty?\n      '<center>&#8212;</center>' # em dash\n    else\n      topic.topic_name\n    end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
      "class": "Participant",
      "score": 0.6,
      "reason": "Method `delete` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 50
      },
      "context": "def delete(force = nil)\n    maps = ResponseMap.where('reviewee_id = ? or reviewer_id = ?', id, id)\n\n    raise 'Associations exist for this participant.' unless force || (maps.blank? && team.nil?)\n\n    force_delete(maps)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
      "class": "Participant",
      "score": 0.8,
      "reason": "Method `force_delete` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 58
      },
      "context": "def force_delete(maps)\n    maps && maps.each(&:destroy)\n    if team && (team.teams_participants.length == 1)\n      team.delete\n    elsif team\n      team.teams_participants.each { |teams_participant| teams_participant.destroy if teams_participant.user_id == id }",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
      "class": "Participant",
      "score": 0.65,
      "reason": "Method `topic_name` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 68
      },
      "context": "def topic_name\n    if topic.nil? || topic.topic_name.empty?\n      '<center>&#8212;</center>' # em dash\n    else\n      topic.topic_name\n    end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
      "class": "SignUpSheet",
      "score": 1.0,
      "reason": "Class exposes 6 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class SignUpSheet < ApplicationRecord\n  # Team lazy initialization method [zhewei, 06/27/2015]\n  def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
      "class": "SignUpSheet",
      "score": 0.6,
      "reason": "Method `signup_team` manipulates external state 5 times vs 3 local accesses.",
      "location": {
        "line": 3
      },
      "context": "def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
      "class": "SignUpSheet",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class SignUpSheet < ApplicationRecord\n  # Team lazy initialization method [zhewei, 06/27/2015]\n  def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_topic.rb",
      "class": "SignUpTopic",
      "score": 0.85,
      "reason": "Method `import` manipulates external state 7 times vs 0 local accesses.",
      "location": {
        "line": 20
      },
      "context": "def self.import(row_hash, session, _id = nil)\n    if row_hash.length < 3\n      raise ArgumentError, 'The CSV File expects the format: Topic identifier, Topic name, Max choosers, Topic Category (optional), Topic Description (Optional), Topic Link (optional).'\n    end\n\n    topic = SignUpTopic.where(topic_name: row_hash[:topic_name], assignment_id: session[:assignment_id]).first",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.6,
      "reason": "Method `topic_id_by_team_id` contains a call chain of length 3.",
      "location": {
        "line": 76
      },
      "context": "def self.topic_id_by_team_id(team_id)\n    signed_up_teams = SignedUpTeam.where(team_id: team_id, is_waitlisted: 0)\n    if signed_up_teams.blank?\n      nil\n    else\n      signed_up_teams.first.topic_id",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 1.0,
      "reason": "Method `find_team_participants` manipulates external state 30 times vs 4 local accesses.",
      "location": {
        "line": 9
      },
      "context": "def self.find_team_participants(assignment_id, ip_address = nil)\n    @participants = SignedUpTeam.joins('INNER JOIN sign_up_topics ON signed_up_teams.topic_id = sign_up_topics.id')\n                                .select('signed_up_teams.id as id, sign_up_topics.id as topic_id, sign_up_topics.topic_name as name,\n                                  sign_up_topics.topic_name as team_name_placeholder, sign_up_topics.topic_name as user_name_placeholder,\n                                  signed_up_teams.is_waitlisted as is_waitlisted, signed_up_teams.team_id as team_id')\n                                .where('sign_up_topics.assignment_id = ?', assignment_id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.8,
      "reason": "Method `find_team_participants` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 41
      },
      "context": "def self.find_team_participants(assignment_id, user_id)\n    TeamsParticipant.joins('INNER JOIN teams ON teams_participants.team_id = teams.id')\n             .select('teams.id as t_id')\n             .where('teams.parent_id = ? and teams_participants.user_id = ?', assignment_id, user_id)\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.95,
      "reason": "Method `find_user_signup_topics` manipulates external state 9 times vs 0 local accesses.",
      "location": {
        "line": 47
      },
      "context": "def self.find_user_signup_topics(assignment_id, team_id)\n    SignedUpTeam.joins('INNER JOIN sign_up_topics ON signed_up_teams.topic_id = sign_up_topics.id')\n                .select('sign_up_topics.id as topic_id, sign_up_topics.topic_name as topic_name, signed_up_teams.is_waitlisted as is_waitlisted,\n                  signed_up_teams.preference_priority_number as preference_priority_number')\n                .where('sign_up_topics.assignment_id = ? and signed_up_teams.team_id = ?', assignment_id, team_id)\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.95,
      "reason": "Method `release_topics_selected_by_team_for_assignment` manipulates external state 9 times vs 0 local accesses.",
      "location": {
        "line": 55
      },
      "context": "def self.release_topics_selected_by_team_for_assignment(team_id, assignment_id)\n    old_teams_signups = SignedUpTeam.where(team_id: team_id)\n\n    # If the team has signed up for the topic and they are on the waitlist then remove that team from the waitlist.\n    unless old_teams_signups.nil?\n      old_teams_signups.each do |old_teams_signup|",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.65,
      "reason": "Method `topic_id_by_team_id` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 76
      },
      "context": "def self.topic_id_by_team_id(team_id)\n    signed_up_teams = SignedUpTeam.where(team_id: team_id, is_waitlisted: 0)\n    if signed_up_teams.blank?\n      nil\n    else\n      signed_up_teams.first.topic_id",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
      "class": "SignedUpTeam",
      "score": 0.65,
      "reason": "Method `drop_signup_record` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 86
      },
      "context": "def self.drop_signup_record(topic_id,team_id)\n    # Fetching record for a given topic and team.\n    signup_record = SignedUpTeam.find_by(topic_id: topic_id, team_id: team_id)\n    # If the signup_record in not nil destroy it.\n    signup_record.destroy unless signup_record.nil?\n  end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_tag_prompt_deployment.rb",
      "class": "TagPromptDeployment",
      "score": 1.0,
      "reason": "Method `get_number_of_taggable_answers` manipulates external state 10 times vs 0 local accesses.",
      "location": {
        "line": 13
      },
      "context": "def get_number_of_taggable_answers(user_id)\n    team = Team.joins(:teams_participants).where(team_participants: { parent_id: assignment_id }, user_id: user_id)\n    responses = Response.joins(:response_maps).where(response_maps: { reviewed_object_id: assignment.id, reviewee_id: team.id })\n    questions = Question.where(questionnaire_id: questionnaire.id, type: question_type)\n\n    unless responses.empty? || questions.empty?",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 3,
        "lines_deleted": 3,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Class exposes 27 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Class directly instantiates 2 collaborators.",
      "location": {
        "line": 1
      },
      "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "OCP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Uses 4 type-checking conditional(s); prefer polymorphism.",
      "location": {
        "line": 1
      },
      "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "DIP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.8,
      "reason": "Directly instantiates 2 concrete collaborators; prefer dependency injection.",
      "location": {
        "line": 1
      },
      "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.6,
      "reason": "Method `randomize_all_by_parent` contains a call chain of length 3.",
      "location": {
        "line": 128
      },
      "context": "def self.randomize_all_by_parent(parent, team_type, min_team_size)\n    participants = Participant.where(parent_id: parent.id, type: parent.class.to_s + 'Participant', can_mentor: [false, nil])\n    participants = participants.sort { rand(-1..1) }\n    users = participants.map { |p| User.find(p.user_id) }.to_a\n    # find teams still need team members and users who are not in any team\n    teams = Team.where(parent_id: parent.id, type: parent.class.to_s + 'Team').to_a",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.6,
      "reason": "Method `create_team_from_single_users` contains a call chain of length 3.",
      "location": {
        "line": 150
      },
      "context": "def self.create_team_from_single_users(min_team_size, parent, team_type, users)\n    num_of_teams = users.length.fdiv(min_team_size).ceil\n    next_team_member_index = 0\n    (1..num_of_teams).to_a.each do |i|\n      team = Object.const_get(team_type + 'Team').create(name: 'Team_' + i.to_s, parent_id: parent.id)\n      TeamNode.create(parent_id: parent.id, node_object_id: team.id)",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.6,
      "reason": "Method `generate_team_name` contains a call chain of length 3.",
      "location": {
        "line": 182
      },
      "context": "def self.generate_team_name(_team_name_prefix = '')\n    last_team = Team.where('name LIKE ?', \"#{_team_name_prefix} Team_%\")\n                  .order(\"CAST(SUBSTRING(name, LENGTH('#{_team_name_prefix} Team_') + 1) AS UNSIGNED) DESC\")\n                  .first\n    counter = last_team ? last_team.name.scan(/\\d+/).first.to_i + 1 : 1\n    team_name = \"#{_team_name_prefix} Team_#{counter}\"",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.7,
      "reason": "Method `copy_content` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 27
      },
      "context": "def self.copy_content(source, destination)\n    source.each do |each_element|\n      each_element.copy(destination.id)\n    end\n  end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.75,
      "reason": "Method `add_member` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 80
      },
      "context": "def add_member(user, _assignment_id = nil)\n    raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n\n    can_add_member = false\n    unless full?\n      can_add_member = true",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.7,
      "reason": "Method `size` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 96
      },
      "context": "def self.size(team_id)\n    #TeamsParticipant.where(team_id: team_id).count\n    count = 0\n    members = TeamsParticipant.where(team_id: team_id)\n    members.each do |member|\n      member_name = member.name",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.75,
      "reason": "Method `copy_members` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 110
      },
      "context": "def copy_members(new_team)\n    members = TeamsParticipant.where(team_id: id)\n    members.each do |member|\n      t_user = TeamsParticipant.create(team_id: new_team.id, user_id: member.user_id)\n      parent = Object.const_get(parent_model).find(parent_id)\n      TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.65,
      "reason": "Method `check_for_existing` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 120
      },
      "context": "def self.check_for_existing(parent, name, team_type)\n    list = Object.const_get(team_type + 'Team').where(parent_id: parent.id, name: name)\n    raise TeamExistsError, \"The team name #{name} is already in use.\" unless list.empty?\n  end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Method `randomize_all_by_parent` manipulates external state 19 times vs 0 local accesses.",
      "location": {
        "line": 128
      },
      "context": "def self.randomize_all_by_parent(parent, team_type, min_team_size)\n    participants = Participant.where(parent_id: parent.id, type: parent.class.to_s + 'Participant', can_mentor: [false, nil])\n    participants = participants.sort { rand(-1..1) }\n    users = participants.map { |p| User.find(p.user_id) }.to_a\n    # find teams still need team members and users who are not in any team\n    teams = Team.where(parent_id: parent.id, type: parent.class.to_s + 'Team').to_a",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Method `create_team_from_single_users` manipulates external state 11 times vs 0 local accesses.",
      "location": {
        "line": 150
      },
      "context": "def self.create_team_from_single_users(min_team_size, parent, team_type, users)\n    num_of_teams = users.length.fdiv(min_team_size).ceil\n    next_team_member_index = 0\n    (1..num_of_teams).to_a.each do |i|\n      team = Object.const_get(team_type + 'Team').create(name: 'Team_' + i.to_s, parent_id: parent.id)\n      TeamNode.create(parent_id: parent.id, node_object_id: team.id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Method `assign_single_users_to_teams` manipulates external state 10 times vs 0 local accesses.",
      "location": {
        "line": 167
      },
      "context": "def self.assign_single_users_to_teams(min_team_size, parent, teams, users)\n    teams.each do |team|\n      curr_team_size = Team.size(team.id)\n      member_num_difference = min_team_size - curr_team_size\n      while member_num_difference > 0\n        team.add_member(users.first, parent.id)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.65,
      "reason": "Method `generate_team_name` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 182
      },
      "context": "def self.generate_team_name(_team_name_prefix = '')\n    last_team = Team.where('name LIKE ?', \"#{_team_name_prefix} Team_%\")\n                  .order(\"CAST(SUBSTRING(name, LENGTH('#{_team_name_prefix} Team_') + 1) AS UNSIGNED) DESC\")\n                  .first\n    counter = last_team ? last_team.name.scan(/\\d+/).first.to_i + 1 : 1\n    team_name = \"#{_team_name_prefix} Team_#{counter}\"",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.65,
      "reason": "Method `import_team_members` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 192
      },
      "context": "def import_team_members(row_hash)\n    row_hash[:teammembers].each_with_index do |teammate, _index|\n      user = User.find_by(name: teammate.to_s)\n      if user.nil?\n        raise ImportError, \"The user '#{teammate}' was not found. <a href='/users/new'>Create</a> this user?\"\n      else",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.85,
      "reason": "Method `import` manipulates external state 7 times vs 0 local accesses.",
      "location": {
        "line": 204
      },
      "context": "def self.import(row_hash, id, options, teamtype)\n    raise ArgumentError, 'Not enough fields on this line.' if row_hash.empty? || (row_hash[:teammembers].empty? && (options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last')) || (row_hash[:teammembers].empty? && (options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last'))\n    if options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last'\n      name = row_hash[:teamname].to_s\n      team = where(['name =? && parent_id =?', name, id]).first\n      team_exists = !team.nil?",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.75,
      "reason": "Method `handle_duplicate` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 228
      },
      "context": "def self.handle_duplicate(team, name, id, handle_dups, teamtype)\n    return name if team.nil? # no duplicate\n    return nil if handle_dups == 'ignore' # ignore: do not create the new team\n\n    if handle_dups == 'rename' # rename: rename new team\n      if teamtype.is_a?(CourseTeam)",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Method `export` manipulates external state 10 times vs 0 local accesses.",
      "location": {
        "line": 248
      },
      "context": "def self.export(csv, parent_id, options, teamtype)\n    if teamtype.is_a?(CourseTeam)\n      teams = CourseTeam.where(parent_id: parent_id)\n    elsif teamtype.is_a?(AssignmentTeam)\n      teams = AssignmentTeam.where(parent_id: parent_id)\n    end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.7,
      "reason": "Method `create_team_and_node` manipulates external state 4 times vs 0 local accesses.",
      "location": {
        "line": 269
      },
      "context": "def self.create_team_and_node(id)\n    parent = parent_model id # current_task will be either a course object or an assignment object.\n    team_name = Team.generate_team_name(parent.name)\n    team = create(name: team_name, parent_id: id)\n    # new teamnode will have current_task.id as parent_id and team_id as node_object_id.\n    TeamNode.create(parent_id: id, node_object_id: team.id)",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": false,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.65,
      "reason": "Method `create_team_with_users` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 294
      },
      "context": "def self.create_team_with_users(parent_id, user_ids)\n    team = create_team_and_node(parent_id)\n\n    user_ids.each do |user_id|\n      remove_user_from_previous_team(parent_id, user_id)",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.65,
      "reason": "Method `remove_user_from_previous_team` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 307
      },
      "context": "def self.remove_user_from_previous_team(parent_id, user_id)\n    team_participant = TeamsParticipant.where(user_id: user_id).find { |team_participant_obj| team_participant_obj.team.parent_id == parent_id }\n    begin\n      team_participant.destroy\n    rescue StandardError\n      nil",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 0.8,
      "reason": "Method `find_team_participants` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 316
      },
      "context": "def self.find_team_participants(assignment_id, user_id)\n    TeamsParticipant.joins('INNER JOIN teams ON teams_participants.team_id = teams.id')\n             .select('teams.id as t_id')\n             .where('teams.parent_id = ? and teams_participants.user_id = ?', assignment_id, user_id)\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
      "class": "Team",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 19,
        "lines_deleted": 19,
        "methods_added": [
          "self"
        ],
        "methods_removed": [
          "self"
        ]
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
      "class": "TeamUserNode",
      "score": 1.0,
      "reason": "Class exposes 4 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class TeamUserNode < Node\n  belongs_to :node_object, class_name: 'TeamsParticipant'\n  # attr_accessible :parent_id, :node_object_id  # unnecessary protected attributes\n\n  def self.table\n    'teams_participants'\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
      "class": "TeamUserNode",
      "score": 0.8,
      "reason": "Method `get` manipulates external state 6 times vs 0 local accesses.",
      "location": {
        "line": 13
      },
      "context": "def self.get(parent_id)\n    nodes = Node.joins('INNER JOIN teams_participants ON nodes.node_object_id = teams_participants.id')\n                .select('nodes.*')\n                .where(\"nodes.type = 'TeamUserNode'\")\n    nodes.where('teams_participants.team_id = ?', parent_id) if parent_id\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
      "class": "TeamUserNode",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class TeamUserNode < Node\n  belongs_to :node_object, class_name: 'TeamsParticipant'\n  # attr_accessible :parent_id, :node_object_id  # unnecessary protected attributes\n\n  def self.table\n    'teams_participants'\n  end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "SRP",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 1.0,
      "reason": "Class exposes 8 methods (limit: 4).",
      "location": {
        "line": 1
      },
      "context": "class TeamsParticipant < ApplicationRecord\n  belongs_to :team\n  belongs_to :participant\n\n  # paper_trail, node, etc\n  has_one    :team_participant_node,\n             foreign_key: 'node_object_id',\n             dependent:   :destroy",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `delete` contains a call chain of length 3.",
      "location": {
        "line": 25
      },
      "context": "def delete\n    team_participant_node&.destroy\n    t = team\n    destroy\n    t.destroy if t.teams_participants.empty?\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `team_id` contains a call chain of length 3.",
      "location": {
        "line": 69
      },
      "context": "def self.team_id(assignment_id, user_id)\n    each_for(user_id).find { |tp| tp.team.parent_id == assignment_id }&.team_id\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `delete` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 25
      },
      "context": "def delete\n    team_participant_node&.destroy\n    t = team\n    destroy\n    t.destroy if t.teams_participants.empty?\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `remove_team` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 33
      },
      "context": "def self.remove_team(user_id, team_id)\n    jp = joins(participant: :user)\n           .where('participants.user_id = ? AND team_id = ?', user_id, team_id)\n           .first\n    jp&.destroy\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.65,
      "reason": "Method `add_member_to_invited_team` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 51
      },
      "context": "def self.add_member_to_invited_team(invitee_user_id, invited_user_id, assignment_id)\n    success = false\n    each_for(invitee_user_id) do |tp|\n      next unless (asg_team = AssignmentTeam.find_by(id: tp.team_id, parent_id: assignment_id))\n      invited_participant = Participant.find_by(user_id: invited_user_id, parent_id: assignment_id)\n      success = asg_team.add_member(invited_participant) if invited_participant",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `each_for` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 62
      },
      "context": "def self.each_for(user_id, &block)\n    joins(participant: :user)\n      .where('participants.user_id = ?', user_id)\n      .each(&block)\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 0.6,
      "reason": "Method `team_id` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 69
      },
      "context": "def self.team_id(assignment_id, user_id)\n    each_for(user_id).find { |tp| tp.team.parent_id == assignment_id }&.team_id\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "ENCAPSULATION",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
      "class": "TeamsParticipant",
      "score": 1.0,
      "reason": "Has 100.0% public methods (limit: 60.0%).",
      "location": {
        "line": 1
      },
      "context": "class TeamsParticipant < ApplicationRecord\n  belongs_to :team\n  belongs_to :participant\n\n  # paper_trail, node, etc\n  has_one    :team_participant_node,\n             foreign_key: 'node_object_id',\n             dependent:   :destroy",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 72,
        "lines_deleted": 0,
        "methods_added": [
          "name",
          "delete",
          "self",
          "self",
          "self",
          "self",
          "self",
          "self"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_019_create_teams_users.rb",
      "class": "CreateTeamsUsers",
      "score": 0.65,
      "reason": "Method `up` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 2
      },
      "context": "def self.up\n    create_table 'teams_participants', force: true do |t|\n      t.column 'team_id', :integer\n      t.column 'user_id', :integer\n    end",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_019_create_teams_users.rb",
      "class": "CreateTeamsUsers",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class CreateTeamsUsers < ActiveRecord::Migration[4.2]\n  def self.up\n    create_table 'teams_participants', force: true do |t|\n      t.column 'team_id', :integer\n      t.column 'user_id', :integer\n    end\n\n    add_index 'teams_participants', ['team_id'], name: 'fk_users_teams'",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 7,
        "lines_deleted": 7,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
      "class": "CreateTeamUserNodes",
      "score": 0.75,
      "reason": "Method `up` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 2
      },
      "context": "def self.up\n    begin\n      remove_column :teams_participants, :assignment_id\n    rescue StandardError\n    end",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
      "class": "CreateTeamUserNodes",
      "score": 0.6,
      "reason": "Method `down` manipulates external state 2 times vs 0 local accesses.",
      "location": {
        "line": 17
      },
      "context": "def self.down\n    teamsusers = TeamsUser.all\n    teamsusers.each(&:destroy)\n\n    add_column :teams_participants, :assignment_id, :integer\n  end",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
      "class": "CreateTeamUserNodes",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class CreateTeamUserNodes < ActiveRecord::Migration[4.2]\n  def self.up\n    begin\n      remove_column :teams_participants, :assignment_id\n    rescue StandardError\n    end\n\n    teamsusers = TeamsUser.all",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20131103014327_create_participant_score_views.rb",
      "class": "CreateParticipantScoreViews",
      "score": 1.0,
      "reason": "Method `up` manipulates external state 20 times vs 0 local accesses.",
      "location": {
        "line": 2
      },
      "context": "def self.up\n    execute <<-SQL\n      CREATE VIEW participant_score_views AS SELECT r.id response_id,s.answer,q.weight,qs.name questionaire_type,qs.max_question_score,t.id as team_id,user_id as participant_id , t.parent_id as assignment_id\n FROM answers s ,responses r, response_maps rm, questions q, questionnaires qs , teams_participants tu , teams t\n WHERE  rm.id = r.map_id AND r.id=s.response_id AND q.id = s.question_id AND qs.id = q.questionnaire_id    AND tu.team_id = rm.reviewee_id   AND tu.team_id = t.id\n    SQL",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20131103014327_create_participant_score_views.rb",
      "class": "CreateParticipantScoreViews",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class CreateParticipantScoreViews < ActiveRecord::Migration[4.2]\n  def self.up\n    execute <<-SQL\n      CREATE VIEW participant_score_views AS SELECT r.id response_id,s.answer,q.weight,qs.name questionaire_type,qs.max_question_score,t.id as team_id,user_id as participant_id , t.parent_id as assignment_id\n FROM answers s ,responses r, response_maps rm, questions q, questionnaires qs , teams_participants tu , teams t\n WHERE  rm.id = r.map_id AND r.id=s.response_id AND q.id = s.question_id AND qs.id = q.questionnaire_id    AND tu.team_id = rm.reviewee_id   AND tu.team_id = t.id\n    SQL\n  end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 1,
        "lines_deleted": 1,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20141111010259_add_index_to_response_maps.rb",
      "class": "AddIndexToResponseMaps",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class AddIndexToResponseMaps < ActiveRecord::Migration[4.2]\n  def self.up\n    # add_index :response_maps, :reviewee_id\n    # add_index :response_maps, :reviewer_id\n    # add_index :response_maps, :reviewed_object_id\n\n    # add_index :teams_participants, :user_id",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20141204022200_add_team_index_to_teams_users.rb",
      "class": "AddTeamIndexToTeamsUsers",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class AddTeamIndexToTeamsUsers < ActiveRecord::Migration[4.2]\n   def self.up\n      #add_index :teams_participants, :team_id\n   end\n\n  def self.down\n    # remove_index :teams_participants, :team_id\n  end",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 2,
        "lines_deleted": 2,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "LAW_OF_DEMETER",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20230415194444_add_participant_id_and_populate.rb",
      "class": "AddParticipantIdAndPopulate",
      "score": 0.6,
      "reason": "Method `up` contains a call chain of length 3.",
      "location": {
        "line": 3
      },
      "context": "def up\n    add_column :teams_participants, :participant_id, :integer, limit: 4, index: true\n    add_foreign_key :teams_participants, :participants\n    # firstly, fetch all TeamsUser rows\n    teams_participants = TeamsUser.all\n    # for each TeamsUser row",
      "confidence": 0.8,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20230415194444_add_participant_id_and_populate.rb",
      "class": "AddParticipantIdAndPopulate",
      "score": 0.95,
      "reason": "Method `up` manipulates external state 9 times vs 0 local accesses.",
      "location": {
        "line": 3
      },
      "context": "def up\n    add_column :teams_participants, :participant_id, :integer, limit: 4, index: true\n    add_foreign_key :teams_participants, :participants\n    # firstly, fetch all TeamsUser rows\n    teams_participants = TeamsUser.all\n    # for each TeamsUser row",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 6,
        "lines_deleted": 6,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20240320000002_add_participant_id_to_teams_participants.rb",
      "class": "AddParticipantIdToTeamsParticipants",
      "score": 0.75,
      "reason": "Method `up` manipulates external state 5 times vs 0 local accesses.",
      "location": {
        "line": 5
      },
      "context": "def up\n      unless column_exists?(:teams_participants, :participant_id)\n        add_column :teams_participants, :participant_id, :integer\n        add_index  :teams_participants, :participant_id, algorithm: :concurrently\n  \n        # backfill: for each row, find the Participant whose user_id = old user_id",
      "confidence": 0.95,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": true,
      "diff_context": {
        "lines_added": 28,
        "lines_deleted": 0,
        "methods_added": [
          "up",
          "down"
        ],
        "methods_removed": []
      }
    },
    {
      "type": "INFORMATION_EXPERT",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_save_020_teams_users.rb",
      "class": "TeamsUsers",
      "score": 0.65,
      "reason": "Method `up` manipulates external state 3 times vs 0 local accesses.",
      "location": {
        "line": 2
      },
      "context": "def self.up\n    create_table :teams_participants do |t| # maps users to teams; in rare cases, a single individual is on > 1 team for an assgt.\n      t.column :team_id, :integer\n      t.column :user_id, :integer\n    end\n    execute \"alter table teams_participants",
      "confidence": 0.85,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [],
        "methods_removed": []
      }
    },
    {
      "type": "OVERUSE_CLASS_METHODS",
      "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_save_020_teams_users.rb",
      "class": "TeamsUsers",
      "score": 0.7,
      "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
      "location": {
        "line": 1
      },
      "context": "class TeamsUsers < ActiveRecord::Migration[4.2]\n  def self.up\n    create_table :teams_participants do |t| # maps users to teams; in rare cases, a single individual is on > 1 team for an assgt.\n      t.column :team_id, :integer\n      t.column :user_id, :integer\n    end\n    execute \"alter table teams_participants\n             add constraint fk_users_teams",
      "confidence": 0.9,
      "justification": "Heuristic fallback confirmation based on strong static signals.",
      "suggestion": "Extract collaborators and follow the cited principle.",
      "in_changed_code": true,
      "near_changed_line": true,
      "in_modified_method": false,
      "diff_context": {
        "lines_added": 5,
        "lines_deleted": 5,
        "methods_added": [],
        "methods_removed": []
      }
    }
  ],
  "file_details": [
    {
      "filename": "app/controllers/assessment360_controller.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_assessment360_controller.rb",
          "class": "Assessment360Controller",
          "score": 0.55,
          "reason": "Method `assignment_grade_summary` manipulates external state 6 times vs 5 local accesses.",
          "location": {
            "line": 131
          },
          "context": "def assignment_grade_summary(cp, assignment_id, penalties)\n    user_id = cp.user_id\n    # topic exists if a team signed up for a topic, which can be found via the user and the assignment\n    topic_id = SignedUpTeam.topic_id(assignment_id, user_id)\n    @topics[cp.id][assignment_id] = SignUpTopic.find_by(id: topic_id)\n    # instructor grade is stored in the team model, which is found by finding the user's team for the assignment",
          "confidence": 0.75,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_assessment360_controller.rb",
          "class": "Assessment360Controller",
          "score": 0.6,
          "reason": "Method `insure_existence_of` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 145
          },
          "context": "def insure_existence_of(course_participants, course)\n    if course_participants.empty?\n      flash[:error] = \"There is no course participant in course #{course.name}\"\n      redirect_back fallback_location: root_path\n    end\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/grades_controller.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_grades_controller.rb",
          "class": "GradesController",
          "score": 0.6,
          "reason": "Method `view_my_scores` contains a call chain of length 3.",
          "location": {
            "line": 58
          },
          "context": "def view_my_scores\n    @participant = AssignmentParticipant.find(params[:id])\n    @team_id = TeamsParticipant.team_id(@participant.parent_id, @participant.user_id)\n    return if redirect_when_disallowed\n\n    @assignment = @participant.assignment",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/invitations_controller.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_invitations_controller.rb",
          "class": "InvitationsController",
          "score": 0.55,
          "reason": "Method `check_team_before_accept` manipulates external state 4 times vs 3 local accesses.",
          "location": {
            "line": 141
          },
          "context": "def check_team_before_accept\n    @inv = Invitation.find(params[:inv_id])\n    # check if the inviter's team is still existing, and have available slot to add the invitee\n    inviter_assignment_team = AssignmentTeam.team(AssignmentParticipant.find_by(user_id: @inv.from_id, parent_id: @inv.assignment_id))\n    if inviter_assignment_team.nil?\n      flash[:error] = 'The team that invited you does not exist anymore.'",
          "confidence": 0.75,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/join_team_requests_controller.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_join_team_requests_controller.rb",
          "class": "JoinTeamRequestsController",
          "score": 0.6,
          "reason": "Method `check_team_status` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 90
          },
          "context": "def check_team_status\n    # check if the advertisement is from a team member and if so disallow requesting invitations\n    team_member = TeamsParticipant.where(['team_id =? and user_id =?', params[:team_id], session[:user][:id]])\n    team = Team.find(params[:team_id])\n    return flash[:error] = 'This team is full.' if team.full?\n    return flash[:error] = 'You are already a member of this team.' unless team_member.empty?",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_join_team_requests_controller.rb",
          "class": "JoinTeamRequestsController",
          "score": 0.6,
          "reason": "Method `respond_after` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 102
          },
          "context": "def respond_after(request)\n    respond_to do |format|\n      format.html\n      format.xml { render xml: request }\n    end\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/lottery_controller.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_lottery_controller.rb",
          "class": "LotteryController",
          "score": 0.9,
          "reason": "Method `create_new_teams_for_bidding_response` manipulates external state 8 times vs 0 local accesses.",
          "location": {
            "line": 85
          },
          "context": "def create_new_teams_for_bidding_response(teams, assignment, users_bidding_info)\n    teams.each do |user_ids|\n      if assignment.auto_assign_mentor\n        new_team = MentoredTeam.create_team_with_users(assignment.id, user_ids)\n      else\n        new_team = AssignmentTeam.create_team_with_users(assignment.id, user_ids)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/pair_programming_controller.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 5,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
          "class": "PairProgrammingController",
          "score": 1.0,
          "reason": "Class exposes 4 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class PairProgrammingController < ApplicationController\n  include AuthorizationHelper\n\n  def action_allowed?\n    current_user_has_student_privileges?\n  end\n\n  def send_invitations",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
          "class": "PairProgrammingController",
          "score": 0.65,
          "reason": "Method `send_invitations` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 8
          },
          "context": "def send_invitations\n    users = TeamsParticipant.where(team_id: params[:team_id])\n    users.each { |user| user.update_attributes(pair_programming_status: \"W\") }\n    TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id).update_attributes(pair_programming_status: \"A\")\n    # ExpertizaLogger.info \"Accepting Invitation #{params[:inv_id]}: #{accepted}\"\n    Team.find(params[:team_id]).update_attributes(pair_programming_request: 1)",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
          "class": "PairProgrammingController",
          "score": 0.6,
          "reason": "Method `accept` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 18
          },
          "context": "def accept\n    user = TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id)\n    user.update_attributes(pair_programming_status: \"A\")\n    flash[:success] = \"Pair Programming Request Accepted Successfully!\"\n    redirect_to view_student_teams_path student_id: params[:student_id]\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
          "class": "PairProgrammingController",
          "score": 0.6,
          "reason": "Method `decline` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 25
          },
          "context": "def decline\n    user = TeamsParticipant.find_by(team_id: params[:team_id], user_id: current_user.id)\n    user.update_attributes(pair_programming_status: \"D\")\n    Team.find(params[:team_id]).update_attributes(pair_programming_request: 0)\n    flash[:success] = \"Pair Programming Request Declined!\"\n    redirect_to view_student_teams_path student_id: params[:student_id]",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_pair_programming_controller.rb",
          "class": "PairProgrammingController",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class PairProgrammingController < ApplicationController\n  include AuthorizationHelper\n\n  def action_allowed?\n    current_user_has_student_privileges?\n  end\n\n  def send_invitations",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/participants_controller.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 4,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
          "class": "ParticipantsController",
          "score": 0.6,
          "reason": "Method `get_user_info` contains a call chain of length 3.",
          "location": {
            "line": 205
          },
          "context": "def get_user_info(team_participant, assignment)\n    user = {}\n    user[:name] = team_participant.name\n    user[:fullname] = team_participant.fullname\n    # set by default\n    permission_granted = false",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "get_user_info"
            ],
            "methods_removed": [
              "get_user_info"
            ]
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
          "class": "ParticipantsController",
          "score": 0.6,
          "reason": "Method `get_signup_topics_for_assignment` contains a call chain of length 3.",
          "location": {
            "line": 221
          },
          "context": "def get_signup_topics_for_assignment(assignment_id, team_info, team_id)\n    signup_topics = SignUpTopic.where('assignment_id = ?', assignment_id)\n    if signup_topics.any?\n      has_topics = true\n      signup_topics.each do |signup_topic|\n        signup_topic.signed_up_teams.each do |signed_up_team|",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "get_user_info"
            ],
            "methods_removed": [
              "get_user_info"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
          "class": "ParticipantsController",
          "score": 0.8,
          "reason": "Method `get_user_info` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 205
          },
          "context": "def get_user_info(team_participant, assignment)\n    user = {}\n    user[:name] = team_participant.name\n    user[:fullname] = team_participant.fullname\n    # set by default\n    permission_granted = false",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "get_user_info"
            ],
            "methods_removed": [
              "get_user_info"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_participants_controller.rb",
          "class": "ParticipantsController",
          "score": 0.8,
          "reason": "Method `get_signup_topics_for_assignment` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 221
          },
          "context": "def get_signup_topics_for_assignment(assignment_id, team_info, team_id)\n    signup_topics = SignUpTopic.where('assignment_id = ?', assignment_id)\n    if signup_topics.any?\n      has_topics = true\n      signup_topics.each do |signup_topic|\n        signup_topic.signed_up_teams.each do |signed_up_team|",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "get_user_info"
            ],
            "methods_removed": [
              "get_user_info"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/controllers/popup_controller.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_popup_controller.rb",
          "class": "PopupController",
          "score": 0.65,
          "reason": "Method `team_participants_popup` manipulates external state 25 times vs 22 local accesses.",
          "location": {
            "line": 35
          },
          "context": "def team_participants_popup\n    @ip = session[:ip]\n    @sum = 0\n    @team = Team.find(params[:id])\n    @assignment = Assignment.find(@team.parent_id)\n    @team_participants = TeamsParticipant.where(team_id: params[:id])",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [
              "team_participants_popup"
            ],
            "methods_removed": [
              "team_users_popup"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/controllers/review_mapping_controller.rb",
      "status": "modified",
      "diff_summary": "10 addition(s), 10 deletion(s) in 7 hunk(s)",
      "changes_analysis": {
        "lines_added": 10,
        "lines_deleted": 10
      },
      "violations_count": 5,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
          "class": "ReviewMappingController",
          "score": 0.6,
          "reason": "Method `automatic_review_mapping` contains a call chain of length 3.",
          "location": {
            "line": 344
          },
          "context": "def automatic_review_mapping\n    assignment_id = params[:id].to_i\n    assignment = Assignment.find(params[:id])\n    participants = AssignmentParticipant.where(parent_id: params[:id].to_i).to_a.select(&:can_review).shuffle!\n    teams = AssignmentTeam.where(parent_id: params[:id].to_i).to_a.shuffle!\n    max_team_size = Integer(params[:max_team_size]) # Assignment.find(assignment_id).max_team_size",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 10,
            "lines_deleted": 10,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
          "class": "ReviewMappingController",
          "score": 0.6,
          "reason": "Method `peer_review_strategy` contains a call chain of length 3.",
          "location": {
            "line": 515
          },
          "context": "def peer_review_strategy(assignment_id, review_strategy, participants_hash)\n    teams = review_strategy.teams\n    participants = review_strategy.participants\n    num_participants = participants.size\n\n    teams.each_with_index do |team, iterator|",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 10,
            "lines_deleted": 10,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
          "class": "ReviewMappingController",
          "score": 1.0,
          "reason": "Method `add_reviewer` manipulates external state 12 times vs 0 local accesses.",
          "location": {
            "line": 54
          },
          "context": "def add_reviewer\n    assignment = Assignment.find(params[:id])\n    topic_id = params[:topic_id]\n    user_id = User.where(name: params[:user][:name]).first.id\n    # If instructor want to assign one student to review his/her own artifact,\n    # it should be counted as \"self-review\" and we need to make /app/views/submitted_content/_selfreview.html.erb work.",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 10,
            "lines_deleted": 10,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
          "class": "ReviewMappingController",
          "score": 1.0,
          "reason": "Method `automatic_review_mapping` manipulates external state 20 times vs 0 local accesses.",
          "location": {
            "line": 344
          },
          "context": "def automatic_review_mapping\n    assignment_id = params[:id].to_i\n    assignment = Assignment.find(params[:id])\n    participants = AssignmentParticipant.where(parent_id: params[:id].to_i).to_a.select(&:can_review).shuffle!\n    teams = AssignmentTeam.where(parent_id: params[:id].to_i).to_a.shuffle!\n    max_team_size = Integer(params[:max_team_size]) # Assignment.find(assignment_id).max_team_size",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 10,
            "lines_deleted": 10,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_review_mapping_controller.rb",
          "class": "ReviewMappingController",
          "score": 1.0,
          "reason": "Method `peer_review_strategy` manipulates external state 40 times vs 0 local accesses.",
          "location": {
            "line": 515
          },
          "context": "def peer_review_strategy(assignment_id, review_strategy, participants_hash)\n    teams = review_strategy.teams\n    participants = review_strategy.participants\n    num_participants = participants.size\n\n    teams.each_with_index do |team, iterator|",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 10,
            "lines_deleted": 10,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/sign_up_sheet_controller.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 6 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
          "class": "SignUpSheetController",
          "score": 0.6,
          "reason": "Method `delete_signup_as_instructor` contains a call chain of length 3.",
          "location": {
            "line": 290
          },
          "context": "def delete_signup_as_instructor\n    # find participant using assignment using team and topic ids\n    team = Team.find(params[:id])\n    assignment = Assignment.find(team.parent_id)\n    user = TeamsParticipant.find_by(team_id: team.id).user\n    participant = AssignmentParticipant.find_by(user_id: user.id, parent_id: assignment.id)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
          "class": "SignUpSheetController",
          "score": 1.0,
          "reason": "Method `delete_signup_as_instructor` manipulates external state 13 times vs 0 local accesses.",
          "location": {
            "line": 290
          },
          "context": "def delete_signup_as_instructor\n    # find participant using assignment using team and topic ids\n    team = Team.find(params[:id])\n    assignment = Assignment.find(team.parent_id)\n    user = TeamsParticipant.find_by(team_id: team.id).user\n    participant = AssignmentParticipant.find_by(user_id: user.id, parent_id: assignment.id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_sign_up_sheet_controller.rb",
          "class": "SignUpSheetController",
          "score": 0.85,
          "reason": "Method `switch_original_topic_to_approved_suggested_topic` manipulates external state 7 times vs 0 local accesses.",
          "location": {
            "line": 424
          },
          "context": "def switch_original_topic_to_approved_suggested_topic\n    assignment = AssignmentParticipant.find(params[:id]).assignment\n    team_id = TeamsParticipant.team_id(assignment.id, session[:user].id)\n\n    # Tmp variable to store topic id before change\n    original_topic_id = SignedUpTeam.topic_id(assignment.id.to_i, session[:user].id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/student_teams_controller.rb",
      "status": "modified",
      "diff_summary": "8 addition(s), 8 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 8,
        "lines_deleted": 8
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
          "class": "StudentTeamsController",
          "score": 0.9,
          "reason": "Method `remove_participant` manipulates external state 8 times vs 0 local accesses.",
          "location": {
            "line": 122
          },
          "context": "def remove_participant\n    # remove the record from teams_participants table\n    team_participant = TeamsParticipant.where(team_id: params[:team_id], user_id: student.user_id)\n    remove_team_participant(team_participant)\n    # if your old team does not have any members, delete the entry for the team\n    if TeamsParticipant.where(team_id: params[:team_id]).empty?",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 8,
            "lines_deleted": 8,
            "methods_added": [
              "remove_team_participant"
            ],
            "methods_removed": [
              "remove_team_user"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
          "class": "StudentTeamsController",
          "score": 0.6,
          "reason": "Method `remove_team_participant` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 143
          },
          "context": "def remove_team_participant(team_participant)\n    return false unless team_participant\n\n    team_participant.destroy_all\n    undo_link \"The user \\\"#{team_participant.name}\\\" has been successfully removed from the team.\"\n    ExpertizaLogger.info LoggerMessage.new(controller_name, session[:user].name, 'User removed a participant from the team', request)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 8,
            "lines_deleted": 8,
            "methods_added": [
              "remove_team_participant"
            ],
            "methods_removed": [
              "remove_team_user"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_student_teams_controller.rb",
          "class": "StudentTeamsController",
          "score": 0.6,
          "reason": "Method `team_created_successfully` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 151
          },
          "context": "def team_created_successfully(current_team = nil)\n    if current_team\n      undo_link \"The team \\\"#{current_team.name}\\\" has been successfully updated.\"\n    else\n      undo_link \"The team \\\"#{team.name}\\\" has been successfully updated.\"\n    end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 8,
            "lines_deleted": 8,
            "methods_added": [
              "remove_team_participant"
            ],
            "methods_removed": [
              "remove_team_user"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/controllers/suggestion_controller.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_suggestion_controller.rb",
          "class": "SuggestionController",
          "score": 0.7,
          "reason": "Method `send_email` manipulates external state 8 times vs 4 local accesses.",
          "location": {
            "line": 94
          },
          "context": "def send_email\n    proposer = User.find_by(id: @user_id)\n    if proposer\n      teams_participants = TeamsParticipant.where(team_id: @team_id)\n      cc_mail_list = []\n      teams_participants.each do |teams_participant|",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/teams_controller.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_controller.rb",
          "class": "TeamsController",
          "score": 0.6,
          "reason": "Method `delete_all` contains a call chain of length 3.",
          "location": {
            "line": 115
          },
          "context": "def delete_all\n    root_node = Object.const_get(session[:team_type] + 'Node').find_by(node_object_id: params[:id])\n    child_nodes = root_node.get_teams.map(&:node_object_id)\n    Team.destroy_all if child_nodes\n    redirect_to action: 'list', id: params[:id]\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_controller.rb",
          "class": "TeamsController",
          "score": 0.6,
          "reason": "Method `delete` contains a call chain of length 3.",
          "location": {
            "line": 123
          },
          "context": "def delete\n    # delete records in team, teams_participants, signed_up_teams table\n    @team = Team.find_by(id: params[:id])\n    unless @team.nil?\n      # Find all SignedUpTeam records associated with the found team.\n      @signed_up_team = SignedUpTeam.where(team_id: @team.id)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 4,
            "lines_deleted": 4,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/teams_participants_controller.rb",
      "status": "added",
      "diff_summary": "71 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 71,
        "lines_deleted": 0
      },
      "violations_count": 7,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 1.0,
          "reason": "Class exposes 8 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "DIP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 0.75,
          "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
          "location": {
            "line": 1
          },
          "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 0.6,
          "reason": "Method `index` contains a call chain of length 3.",
          "location": {
            "line": 6
          },
          "context": "def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 0.7,
          "reason": "Method `create` contains a call chain of length 4.",
          "location": {
            "line": 17
          },
          "context": "def create\n    user = User.find_by(name: join_params[:user_name])\n    unless user\n      flash.now[:error] = \"No user found with name #{join_params[:user_name].inspect}\"\n      return render :new, status: :unprocessable_entity\n    end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 0.85,
          "reason": "Method `create` manipulates external state 11 times vs 4 local accesses.",
          "location": {
            "line": 17
          },
          "context": "def create\n    user = User.find_by(name: join_params[:user_name])\n    unless user\n      flash.now[:error] = \"No user found with name #{join_params[:user_name].inspect}\"\n      return render :new, status: :unprocessable_entity\n    end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 0.55,
          "reason": "Method `delete_selected` manipulates external state 3 times vs 2 local accesses.",
          "location": {
            "line": 51
          },
          "context": "def delete_selected\n    ids     = Array(params[:selected]).map(&:to_i).uniq\n    deleted = TeamsParticipant.where(id: ids, team_id: @team.id).destroy_all\n    flash[:notice] = \"Removed #{deleted.size} #{'member'.pluralize(deleted.size)}.\"\n    redirect_to team_teams_participants_path(@team)\n  end",
          "confidence": 0.75,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_controllers_teams_participants_controller.rb",
          "class": "TeamsParticipantsController",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class TeamsParticipantsController < ApplicationController\n  before_action :set_team,   only: %i[index new create delete_selected]\n  before_action :set_member, only: %i[destroy]\n\n  # GET /teams/:team_id/teams_participants\n  def index\n    @assignment         = @team.parent\n    @teams_participants = @team.teams_participants.includes(participant: :user)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 71,
            "lines_deleted": 0,
            "methods_added": [
              "index",
              "new",
              "create",
              "destroy",
              "delete_selected",
              "set_team",
              "set_member",
              "join_params"
            ],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/controllers/teams_users_controller.rb",
      "status": "removed",
      "diff_summary": "0 addition(s), 112 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 0,
        "lines_deleted": 112
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/controllers/users_controller.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/helpers/assignment_helper.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_assignment_helper.rb",
          "class": "AssignmentHelper",
          "score": 0.9,
          "reason": "Method `get_data_for_list_submissions` manipulates external state 9 times vs 1 local accesses.",
          "location": {
            "line": 78
          },
          "context": "def get_data_for_list_submissions(team)\n    teams_participants = TeamsParticipant.where(team_id: team.id)\n    topic = SignedUpTeam.where(team_id: team.id).first.try :topic\n    topic_identifier = topic.try :topic_identifier\n    topic_name = topic.try :topic_name\n    users_for_curr_team = []",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_assignment_helper.rb",
          "class": "AssignmentHelper",
          "score": 0.6,
          "reason": "Method `get_team_name_color_in_list_submission` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 95
          },
          "context": "def get_team_name_color_in_list_submission(team)\n    if team.try(:grade_for_submission) && team.try(:comment_for_submission)\n      '#cd6133' # brown. submission grade has been assigned.\n    else\n      '#0984e3' # submission grade is not assigned yet.\n    end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/helpers/manage_team_helper.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "DIP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_manage_team_helper.rb",
          "class": "ManageTeamHelper",
          "score": 0.75,
          "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
          "location": {
            "line": 4
          },
          "context": "module ManageTeamHelper\n  # Adds a user specified by 'user' object to a team specified by 'team_id'\n  def create_team_participants(user, team_id)\n    # if user does not exist flash message\n    unless user\n      urlCreate = url_for controller: 'users', action: 'new'\n      ExpertizaLogger.error LoggerMessage.new('ManageTeamHelper', '', 'User being added to the team does not exist!', request)\n      flash[:error] = \"\\\"#{params[:user][:name].strip}\\\" is not defined. Please <a href=\\\"#{urlCreate}\\\">create</a> this user before continuing.\"",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [
              "create_team_participants"
            ],
            "methods_removed": [
              "create_team_users"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_manage_team_helper.rb",
          "class": "ManageTeamHelper",
          "score": 0.6,
          "reason": "Method `create_team_participants` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 6
          },
          "context": "def create_team_participants(user, team_id)\n    # if user does not exist flash message\n    unless user\n      urlCreate = url_for controller: 'users', action: 'new'\n      ExpertizaLogger.error LoggerMessage.new('ManageTeamHelper', '', 'User being added to the team does not exist!', request)\n      flash[:error] = \"\\\"#{params[:user][:name].strip}\\\" is not defined. Please <a href=\\\"#{urlCreate}\\\">create</a> this user before continuing.\"",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [
              "create_team_participants"
            ],
            "methods_removed": [
              "create_team_users"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/helpers/review_mapping_helper.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 3 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 4,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
          "class": "ReviewMappingHelper",
          "score": 0.6,
          "reason": "Method `get_team_reviewed_link_name` contains a call chain of length 3.",
          "location": {
            "line": 116
          },
          "context": "def get_team_reviewed_link_name(max_team_size, _response, reviewee_id, ip_address)\n    team_reviewed_link_name = if max_team_size == 1\n                                TeamsParticipant.where(team_id: reviewee_id).first.user.fullname(ip_address)\n                              else\n                                # E1991 : check anonymized view here\n                                Team.find(reviewee_id).name",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
          "class": "ReviewMappingHelper",
          "score": 0.6,
          "reason": "Method `link_updated_since_last?` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 109
          },
          "context": "def link_updated_since_last?(round, due_dates, link_updated_at)\n    submission_due_date = due_dates.where(round: round, deadline_type_id: 1).try(:first).try(:due_at)\n    submission_due_last_round = due_dates.where(round: round - 1, deadline_type_id: 1).try(:first).try(:due_at)\n    (link_updated_at < submission_due_date) && (link_updated_at > submission_due_last_round)\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
          "class": "ReviewMappingHelper",
          "score": 0.65,
          "reason": "Method `get_team_reviewed_link_name` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 116
          },
          "context": "def get_team_reviewed_link_name(max_team_size, _response, reviewee_id, ip_address)\n    team_reviewed_link_name = if max_team_size == 1\n                                TeamsParticipant.where(team_id: reviewee_id).first.user.fullname(ip_address)\n                              else\n                                # E1991 : check anonymized view here\n                                Team.find(reviewee_id).name",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_review_mapping_helper.rb",
          "class": "ReviewMappingHelper",
          "score": 0.65,
          "reason": "Method `get_css_style_for_calibration_report` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 402
          },
          "context": "def get_css_style_for_calibration_report(diff)\n    # diff - difference between stu's answer and instructor's answer\n    dict = { 0 => 'c5', 1 => 'c4', 2 => 'c3', 3 => 'c2' }\n    css_class = if dict.key?(diff.abs)\n                  dict[diff.abs]\n                else",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/helpers/sign_up_sheet_helper.rb",
      "status": "modified",
      "diff_summary": "7 addition(s), 7 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 7,
        "lines_deleted": 7
      },
      "violations_count": 5,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
          "class": "SignUpSheetHelper",
          "score": 0.6,
          "reason": "Method `get_intelligent_topic_row` contains a call chain of length 3.",
          "location": {
            "line": 33
          },
          "context": "def get_intelligent_topic_row(topic, selected_topics, max_team_size = 3)\n    row_html = ''\n    if selected_topics.present?\n      selected_topics.each do |selected_topic|\n        row_html = if (selected_topic.topic_id == topic.id) && !selected_topic.is_waitlisted\n                     '<tr bgcolor=\"yellow\">'",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
          "class": "SignUpSheetHelper",
          "score": 0.7,
          "reason": "Method `render_participant_info` contains a call chain of length 4.",
          "location": {
            "line": 59
          },
          "context": "def render_participant_info(topic, assignment, participants)\n    html = ''\n    if participants.present?\n      chooser_present = false\n      participants.each do |participant|\n        next unless topic.id == participant.topic_id",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
          "class": "SignUpSheetHelper",
          "score": 0.55,
          "reason": "Method `get_suggested_topics` manipulates external state 2 times vs 1 local accesses.",
          "location": {
            "line": 22
          },
          "context": "def get_suggested_topics(assignment_id)\n    team_id = TeamsParticipant.team_id(assignment_id, session[:user].id)\n    teams_participants = TeamsParticipant.where(team_id: team_id)\n    teams_participants_array = []\n    teams_participants.each do |teams_participant|\n      teams_participants_array << teams_participant.user_id",
          "confidence": 0.75,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
          "class": "SignUpSheetHelper",
          "score": 1.0,
          "reason": "Method `get_intelligent_topic_row` manipulates external state 11 times vs 0 local accesses.",
          "location": {
            "line": 33
          },
          "context": "def get_intelligent_topic_row(topic, selected_topics, max_team_size = 3)\n    row_html = ''\n    if selected_topics.present?\n      selected_topics.each do |selected_topic|\n        row_html = if (selected_topic.topic_id == topic.id) && !selected_topic.is_waitlisted\n                     '<tr bgcolor=\"yellow\">'",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_helpers_sign_up_sheet_helper.rb",
          "class": "SignUpSheetHelper",
          "score": 1.0,
          "reason": "Method `render_participant_info` manipulates external state 15 times vs 0 local accesses.",
          "location": {
            "line": 59
          },
          "context": "def render_participant_info(topic, assignment, participants)\n    html = ''\n    if participants.present?\n      chooser_present = false\n      participants.each do |participant|\n        next unless topic.id == participant.topic_id",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/helpers/teams_participants_helper.rb",
      "status": "added",
      "diff_summary": "2 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/helpers/teams_users_helper.rb",
      "status": "removed",
      "diff_summary": "0 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 0,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/mailers/mail_worker.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 6,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.6,
          "reason": "Method `find_participant_emails` contains a call chain of length 3.",
          "location": {
            "line": 61
          },
          "context": "def find_participant_emails\n    emails = []\n    participants = Participant.where(parent_id: assignment_id)\n    participants.each do |participant|\n      emails << participant.user.email unless participant.user.nil?\n    end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.6,
          "reason": "Method `drop_one_member_topics` contains a call chain of length 3.",
          "location": {
            "line": 70
          },
          "context": "def drop_one_member_topics\n    teams = TeamsParticipant.all.group(:team_id).count(:team_id)\n    teams.keys.each do |team_id|\n      if teams[team_id] == 1\n        topic_to_drop = SignedUpTeam.where(team_id: team_id).first\n        topic_to_drop.delete if topic_to_drop # check if the one-person-team has signed up a topic",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.6,
          "reason": "Method `drop_outstanding_reviews` contains a call chain of length 3.",
          "location": {
            "line": 80
          },
          "context": "def drop_outstanding_reviews\n    reviews = ResponseMap.where(reviewed_object_id: assignment_id)\n    reviews.each do |review|\n      review_has_began = Response.where(map_id: review.id)\n      if review_has_began.size.zero?\n        review_to_drop = ResponseMap.where(id: review.id)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.65,
          "reason": "Method `find_participant_emails` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 61
          },
          "context": "def find_participant_emails\n    emails = []\n    participants = Participant.where(parent_id: assignment_id)\n    participants.each do |participant|\n      emails << participant.user.email unless participant.user.nil?\n    end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.65,
          "reason": "Method `drop_one_member_topics` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 70
          },
          "context": "def drop_one_member_topics\n    teams = TeamsParticipant.all.group(:team_id).count(:team_id)\n    teams.keys.each do |team_id|\n      if teams[team_id] == 1\n        topic_to_drop = SignedUpTeam.where(team_id: team_id).first\n        topic_to_drop.delete if topic_to_drop # check if the one-person-team has signed up a topic",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_mailers_mail_worker.rb",
          "class": "MailWorker",
          "score": 0.75,
          "reason": "Method `drop_outstanding_reviews` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 80
          },
          "context": "def drop_outstanding_reviews\n    reviews = ResponseMap.where(reviewed_object_id: assignment_id)\n    reviews.each do |review|\n      review_has_began = Response.where(map_id: review.id)\n      if review_has_began.size.zero?\n        review_to_drop = ResponseMap.where(id: review.id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/assignment.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
          "class": "Assignment",
          "score": 0.6,
          "reason": "Method `remove_empty_teams` contains a call chain of length 3.",
          "location": {
            "line": 102
          },
          "context": "def remove_empty_teams\n    empty_teams = teams.reload.select { |team| team.teams_participants.empty? }\n    teams.delete(empty_teams)\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
          "class": "Assignment",
          "score": 0.65,
          "reason": "Method `remove_empty_teams` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 102
          },
          "context": "def remove_empty_teams\n    empty_teams = teams.reload.select { |team| team.teams_participants.empty? }\n    teams.delete(empty_teams)\n  end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment.rb",
          "class": "Assignment",
          "score": 0.65,
          "reason": "Method `valid_num_review` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 108
          },
          "context": "def valid_num_review\n    self.num_reviews = num_reviews_allowed\n    if num_reviews_greater?(num_reviews_required, num_reviews_allowed)\n      errors.add(:message, 'Num of reviews required cannot be greater than number of reviews allowed')\n    elsif num_reviews_greater?(num_metareviews_required, num_metareviews_allowed)\n      errors.add(:message, 'Number of Meta-Reviews required cannot be greater than number of meta-reviews allowed')",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/assignment_participant.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_participant.rb",
          "class": "AssignmentParticipant",
          "score": 0.6,
          "reason": "Method `review_file_path` contains a call chain of length 3.",
          "location": {
            "line": 171
          },
          "context": "def review_file_path(response_map_id = nil, participant = nil)\n    if response_map_id.nil?\n      return if participant.nil?\n\n      no_team_path = assignment.path + '/' + participant.name.parameterize(separator: '_') + '_review'\n      return no_team_path if participant.team.nil?",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "team_participant"
            ],
            "methods_removed": [
              "team_user"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_participant.rb",
          "class": "AssignmentParticipant",
          "score": 1.0,
          "reason": "Method `review_file_path` manipulates external state 12 times vs 0 local accesses.",
          "location": {
            "line": 171
          },
          "context": "def review_file_path(response_map_id = nil, participant = nil)\n    if response_map_id.nil?\n      return if participant.nil?\n\n      no_team_path = assignment.path + '/' + participant.name.parameterize(separator: '_') + '_review'\n      return no_team_path if participant.team.nil?",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [
              "team_participant"
            ],
            "methods_removed": [
              "team_user"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/models/assignment_team.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
          "class": "AssignmentTeam",
          "score": 0.9,
          "reason": "Method `team` manipulates external state 8 times vs 0 local accesses.",
          "location": {
            "line": 212
          },
          "context": "def self.team(participant)\n    return nil if participant.nil?\n\n    team = nil\n    teams_participants = TeamsParticipant.where(user_id: participant.user_id)\n    return nil unless teams_participants",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
          "class": "AssignmentTeam",
          "score": 0.7,
          "reason": "Method `export_fields` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 230
          },
          "context": "def self.export_fields(options)\n    fields = []\n    fields.push('Team Name')\n    fields.push('Team members') if options[:team_name] == 'false'\n    fields.push('Assignment Name')\n  end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_assignment_team.rb",
          "class": "AssignmentTeam",
          "score": 0.7,
          "reason": "Method `create_new_team` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 283
          },
          "context": "def create_new_team(user_id, signuptopic)\n    t_user = TeamsParticipant.create(team_id: id, user_id: user_id)\n    SignedUpTeam.create(topic_id: signuptopic.id, team_id: id, is_waitlisted: 0)\n    parent = TeamNode.create(parent_id: signuptopic.assignment_id, node_object_id: id)\n    TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)\n  end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/cake.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 4,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
          "class": "Cake",
          "score": 0.6,
          "reason": "Method `calculate_total_score` contains a call chain of length 3.",
          "location": {
            "line": 116
          },
          "context": "def calculate_total_score(question_answers)\n    question_score = 0.0\n    question_answers.each do |question_answer|\n      # calculate score per question\n      unless question_answer.answer.nil?\n        question_score += question_answer.answer",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
          "class": "Cake",
          "score": 0.7,
          "reason": "Method `get_total_score_for_question` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 96
          },
          "context": "def get_total_score_for_question(review_type, question_id, participant_id, assignment_id, reviewee_id)\n    # get the reviewer's team id for the currently answered question\n    team_id = Team.joins([:teams_participants, teams_participants: [{ user: :participants }]]).where('participants.id = ? and teams.parent_id in (?)', participant_id, assignment_id).first\n    team_id = team_id.id if team_id\n    if review_type == 'TeammateReviewResponseMap'\n      answers_for_team_members = get_answers_for_teammatereview(team_id, question_id, participant_id, assignment_id, reviewee_id)",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
          "class": "Cake",
          "score": 0.85,
          "reason": "Method `get_answers_for_teammatereview` manipulates external state 7 times vs 0 local accesses.",
          "location": {
            "line": 107
          },
          "context": "def get_answers_for_teammatereview(team_id, question_id, participant_id, assignment_id, reviewee_id)\n    # get the reviewer's team members for the currently answered question\n    team_members = Participant.joins(user: :teams_participants).where('teams_participants.team_id in (?) and participants.parent_id in (?)', team_id, assignment_id).ids\n    # get the reviewer's ratings for his team members\n    Answer.joins([{ response: :response_map }, :question]).where(\"response_maps.reviewee_id in (?) and response_maps.reviewed_object_id = (?)\n      and answer is not null and response_maps.reviewer_id in (?) and answers.question_id in (?) and response_maps.reviewee_id not in (?)\", team_members, assignment_id, participant_id, question_id, reviewee_id).to_a",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_cake.rb",
          "class": "Cake",
          "score": 0.65,
          "reason": "Method `calculate_total_score` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 116
          },
          "context": "def calculate_total_score(question_answers)\n    question_score = 0.0\n    question_answers.each do |question_answer|\n      # calculate score per question\n      unless question_answer.answer.nil?\n        question_score += question_answer.answer",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/course_team.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_course_team.rb",
          "class": "CourseTeam",
          "score": 0.7,
          "reason": "Method `add_member` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 70
          },
          "context": "def add_member(user, _id = nil)\n    raise \"The user \\\"#{user.name}\\\" is already a member of the team, \\\"#{name}\\\"\" if user?(user)\n\n    t_user = TeamsParticipant.create(user_id: user.id, team_id: id)\n    parent = TeamNode.find_by(node_object_id: id)\n    TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/invitation.rb",
      "status": "modified",
      "diff_summary": "12 addition(s), 12 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 12,
        "lines_deleted": 12
      },
      "violations_count": 4,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
          "class": "Invitation",
          "score": 0.6,
          "reason": "Method `remove_users_sent_invites_for_assignment` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 20
          },
          "context": "def self.remove_users_sent_invites_for_assignment(user_id, assignment_id)\n    invites = Invitation.where('from_id = ? and assignment_id = ?', user_id, assignment_id)\n    invites.each(&:destroy)\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 12,
            "lines_deleted": 12,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
          "class": "Invitation",
          "score": 0.6,
          "reason": "Method `update_users_topic_after_invite_accept` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 26
          },
          "context": "def self.update_users_topic_after_invite_accept(invitee_user_id, invited_user_id, assignment_id)\n    new_team_id = TeamsParticipant.team_id(assignment_id, invitee_user_id)\n    # check the invited_user_id have ever join other team in this assignment before\n    # if so, update the original record; else create a new record\n    original_team_id = TeamsParticipant.team_id(assignment_id, invited_user_id)\n    if original_team_id",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 12,
            "lines_deleted": 12,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
          "class": "Invitation",
          "score": 0.55,
          "reason": "Method `accept_invitation` manipulates external state 2 times vs 1 local accesses.",
          "location": {
            "line": 45
          },
          "context": "def self.accept_invitation(team_id, inviter_user_id, invited_user_id, assignment_id)\n    # if you are on a team and you accept another invitation and if your old team does not have any members, delete the entry for the team\n    if TeamsParticipant.team_empty?(team_id) && (team_id != '0')\n      assignment_id = AssignmentTeam.find(team_id).assignment.id\n      # Release topics for the team has selected by the invited users empty team\n      SignedUpTeam.release_topics_selected_by_team_for_assignment(team_id, assignment_id)",
          "confidence": 0.75,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 12,
            "lines_deleted": 12,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_invitation.rb",
          "class": "Invitation",
          "score": 0.6,
          "reason": "Method `is_invited?` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 68
          },
          "context": "def self.is_invited?(invitee_user_id, invited_user_id, assignment_id)\n    sent_invitation = Invitation.where('from_id = ? and to_id = ? and assignment_id = ? and reply_status = \"W\"',\n                                       invitee_user_id, invited_user_id, assignment_id)\n    sent_invitation.empty?\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 12,
            "lines_deleted": 12,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/mentor_management.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
          "class": "MentorManagement",
          "score": 0.6,
          "reason": "Method `assign_mentor` contains a call chain of length 3.",
          "location": {
            "line": 43
          },
          "context": "def self.assign_mentor(assignment_id, team_id)\n    assignment = Assignment.find(assignment_id)\n    team = Team.find(team_id)\n\n    # RuboCop 'use guard clause instead of nested conditionals'\n    # return if assignments can't accept mentors",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
          "class": "MentorManagement",
          "score": 0.9,
          "reason": "Method `assign_mentor` manipulates external state 8 times vs 0 local accesses.",
          "location": {
            "line": 43
          },
          "context": "def self.assign_mentor(assignment_id, team_id)\n    assignment = Assignment.find(assignment_id)\n    team = Team.find(team_id)\n\n    # RuboCop 'use guard clause instead of nested conditionals'\n    # return if assignments can't accept mentors",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentor_management.rb",
          "class": "MentorManagement",
          "score": 0.75,
          "reason": "Method `zip_mentors_with_team_count` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 124
          },
          "context": "def self.zip_mentors_with_team_count(assignment_id)\n    mentor_ids = mentors_for_assignment(assignment_id).pluck(:user_id)\n    return [] if mentor_ids.empty?\n    team_counts = {}\n    mentor_ids.each { |id| team_counts[id] = 0 }\n    #E2351 removed (:team_id) after .count to fix balancing algorithm",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/mentored_team.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 4,
      "violations": [
        {
          "type": "DIP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
          "class": "MentoredTeam",
          "score": 0.75,
          "reason": "Directly instantiates 1 concrete collaborators; prefer dependency injection.",
          "location": {
            "line": 1
          },
          "context": "class MentoredTeam < AssignmentTeam\n    # Class created during refactoring of E2351\n    # Overridden method to include the MentorManagement workflow\n    def add_member(user, _assignment_id = nil)\n        raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n    \n        can_add_member = false\n        unless full?",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
          "class": "MentoredTeam",
          "score": 0.7,
          "reason": "Method `import_team_members` contains a call chain of length 4.",
          "location": {
            "line": 22
          },
          "context": "def import_team_members(row_hash)\n        row_hash[:teammembers].each_with_index do |teammate, _index|\n          if teammate.to_s.strip.empty?\n            next\n          end\n          user = User.find_by(name: teammate.to_s)",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
          "class": "MentoredTeam",
          "score": 0.75,
          "reason": "Method `add_member` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 4
          },
          "context": "def add_member(user, _assignment_id = nil)\n        raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n    \n        can_add_member = false\n        unless full?\n          can_add_member = true",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_mentored_team.rb",
          "class": "MentoredTeam",
          "score": 0.75,
          "reason": "Method `import_team_members` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 22
          },
          "context": "def import_team_members(row_hash)\n        row_hash[:teammembers].each_with_index do |teammate, _index|\n          if teammate.to_s.strip.empty?\n            next\n          end\n          user = User.find_by(name: teammate.to_s)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/participant.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 5,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
          "class": "Participant",
          "score": 0.6,
          "reason": "Method `force_delete` contains a call chain of length 3.",
          "location": {
            "line": 58
          },
          "context": "def force_delete(maps)\n    maps && maps.each(&:destroy)\n    if team && (team.teams_participants.length == 1)\n      team.delete\n    elsif team\n      team.teams_participants.each { |teams_participant| teams_participant.destroy if teams_participant.user_id == id }",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
          "class": "Participant",
          "score": 0.6,
          "reason": "Method `topic_name` contains a call chain of length 3.",
          "location": {
            "line": 68
          },
          "context": "def topic_name\n    if topic.nil? || topic.topic_name.empty?\n      '<center>&#8212;</center>' # em dash\n    else\n      topic.topic_name\n    end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
          "class": "Participant",
          "score": 0.6,
          "reason": "Method `delete` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 50
          },
          "context": "def delete(force = nil)\n    maps = ResponseMap.where('reviewee_id = ? or reviewer_id = ?', id, id)\n\n    raise 'Associations exist for this participant.' unless force || (maps.blank? && team.nil?)\n\n    force_delete(maps)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
          "class": "Participant",
          "score": 0.8,
          "reason": "Method `force_delete` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 58
          },
          "context": "def force_delete(maps)\n    maps && maps.each(&:destroy)\n    if team && (team.teams_participants.length == 1)\n      team.delete\n    elsif team\n      team.teams_participants.each { |teams_participant| teams_participant.destroy if teams_participant.user_id == id }",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_participant.rb",
          "class": "Participant",
          "score": 0.65,
          "reason": "Method `topic_name` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 68
          },
          "context": "def topic_name\n    if topic.nil? || topic.topic_name.empty?\n      '<center>&#8212;</center>' # em dash\n    else\n      topic.topic_name\n    end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/review_response_map.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/models/sign_up_sheet.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
          "class": "SignUpSheet",
          "score": 1.0,
          "reason": "Class exposes 6 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class SignUpSheet < ApplicationRecord\n  # Team lazy initialization method [zhewei, 06/27/2015]\n  def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
          "class": "SignUpSheet",
          "score": 0.6,
          "reason": "Method `signup_team` manipulates external state 5 times vs 3 local accesses.",
          "location": {
            "line": 3
          },
          "context": "def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_sheet.rb",
          "class": "SignUpSheet",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class SignUpSheet < ApplicationRecord\n  # Team lazy initialization method [zhewei, 06/27/2015]\n  def self.signup_team(assignment_id, user_id, topic_id = nil)\n    # Find the team ID for the given assignment and user\n    team_id = Team.find_team_participants(assignment_id, user_id)&.first&.t_id\n    # If the team doesn't exist, create a new team and assign the team ID\n    if team_id.nil?\n      team = AssignmentTeam.create_team_with_users(assignment_id, [user_id])",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/sign_up_topic.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_sign_up_topic.rb",
          "class": "SignUpTopic",
          "score": 0.85,
          "reason": "Method `import` manipulates external state 7 times vs 0 local accesses.",
          "location": {
            "line": 20
          },
          "context": "def self.import(row_hash, session, _id = nil)\n    if row_hash.length < 3\n      raise ArgumentError, 'The CSV File expects the format: Topic identifier, Topic name, Max choosers, Topic Category (optional), Topic Description (Optional), Topic Link (optional).'\n    end\n\n    topic = SignUpTopic.where(topic_name: row_hash[:topic_name], assignment_id: session[:assignment_id]).first",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/signed_up_team.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 3 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 7,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.6,
          "reason": "Method `topic_id_by_team_id` contains a call chain of length 3.",
          "location": {
            "line": 76
          },
          "context": "def self.topic_id_by_team_id(team_id)\n    signed_up_teams = SignedUpTeam.where(team_id: team_id, is_waitlisted: 0)\n    if signed_up_teams.blank?\n      nil\n    else\n      signed_up_teams.first.topic_id",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 1.0,
          "reason": "Method `find_team_participants` manipulates external state 30 times vs 4 local accesses.",
          "location": {
            "line": 9
          },
          "context": "def self.find_team_participants(assignment_id, ip_address = nil)\n    @participants = SignedUpTeam.joins('INNER JOIN sign_up_topics ON signed_up_teams.topic_id = sign_up_topics.id')\n                                .select('signed_up_teams.id as id, sign_up_topics.id as topic_id, sign_up_topics.topic_name as name,\n                                  sign_up_topics.topic_name as team_name_placeholder, sign_up_topics.topic_name as user_name_placeholder,\n                                  signed_up_teams.is_waitlisted as is_waitlisted, signed_up_teams.team_id as team_id')\n                                .where('sign_up_topics.assignment_id = ?', assignment_id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.8,
          "reason": "Method `find_team_participants` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 41
          },
          "context": "def self.find_team_participants(assignment_id, user_id)\n    TeamsParticipant.joins('INNER JOIN teams ON teams_participants.team_id = teams.id')\n             .select('teams.id as t_id')\n             .where('teams.parent_id = ? and teams_participants.user_id = ?', assignment_id, user_id)\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.95,
          "reason": "Method `find_user_signup_topics` manipulates external state 9 times vs 0 local accesses.",
          "location": {
            "line": 47
          },
          "context": "def self.find_user_signup_topics(assignment_id, team_id)\n    SignedUpTeam.joins('INNER JOIN sign_up_topics ON signed_up_teams.topic_id = sign_up_topics.id')\n                .select('sign_up_topics.id as topic_id, sign_up_topics.topic_name as topic_name, signed_up_teams.is_waitlisted as is_waitlisted,\n                  signed_up_teams.preference_priority_number as preference_priority_number')\n                .where('sign_up_topics.assignment_id = ? and signed_up_teams.team_id = ?', assignment_id, team_id)\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.95,
          "reason": "Method `release_topics_selected_by_team_for_assignment` manipulates external state 9 times vs 0 local accesses.",
          "location": {
            "line": 55
          },
          "context": "def self.release_topics_selected_by_team_for_assignment(team_id, assignment_id)\n    old_teams_signups = SignedUpTeam.where(team_id: team_id)\n\n    # If the team has signed up for the topic and they are on the waitlist then remove that team from the waitlist.\n    unless old_teams_signups.nil?\n      old_teams_signups.each do |old_teams_signup|",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.65,
          "reason": "Method `topic_id_by_team_id` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 76
          },
          "context": "def self.topic_id_by_team_id(team_id)\n    signed_up_teams = SignedUpTeam.where(team_id: team_id, is_waitlisted: 0)\n    if signed_up_teams.blank?\n      nil\n    else\n      signed_up_teams.first.topic_id",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_signed_up_team.rb",
          "class": "SignedUpTeam",
          "score": 0.65,
          "reason": "Method `drop_signup_record` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 86
          },
          "context": "def self.drop_signup_record(topic_id,team_id)\n    # Fetching record for a given topic and team.\n    signup_record = SignedUpTeam.find_by(topic_id: topic_id, team_id: team_id)\n    # If the signup_record in not nil destroy it.\n    signup_record.destroy unless signup_record.nil?\n  end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/models/tag_prompt_deployment.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_tag_prompt_deployment.rb",
          "class": "TagPromptDeployment",
          "score": 1.0,
          "reason": "Method `get_number_of_taggable_answers` manipulates external state 10 times vs 0 local accesses.",
          "location": {
            "line": 13
          },
          "context": "def get_number_of_taggable_answers(user_id)\n    team = Team.joins(:teams_participants).where(team_participants: { parent_id: assignment_id }, user_id: user_id)\n    responses = Response.joins(:response_maps).where(response_maps: { reviewed_object_id: assignment.id, reviewee_id: team.id })\n    questions = Question.where(questionnaire_id: questionnaire.id, type: question_type)\n\n    unless responses.empty? || questions.empty?",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 3,
            "lines_deleted": 3,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/team.rb",
      "status": "modified",
      "diff_summary": "19 addition(s), 19 deletion(s) in 9 hunk(s)",
      "changes_analysis": {
        "lines_added": 19,
        "lines_deleted": 19
      },
      "violations_count": 25,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Class exposes 27 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Class directly instantiates 2 collaborators.",
          "location": {
            "line": 1
          },
          "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "OCP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Uses 4 type-checking conditional(s); prefer polymorphism.",
          "location": {
            "line": 1
          },
          "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "DIP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.8,
          "reason": "Directly instantiates 2 concrete collaborators; prefer dependency injection.",
          "location": {
            "line": 1
          },
          "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.6,
          "reason": "Method `randomize_all_by_parent` contains a call chain of length 3.",
          "location": {
            "line": 128
          },
          "context": "def self.randomize_all_by_parent(parent, team_type, min_team_size)\n    participants = Participant.where(parent_id: parent.id, type: parent.class.to_s + 'Participant', can_mentor: [false, nil])\n    participants = participants.sort { rand(-1..1) }\n    users = participants.map { |p| User.find(p.user_id) }.to_a\n    # find teams still need team members and users who are not in any team\n    teams = Team.where(parent_id: parent.id, type: parent.class.to_s + 'Team').to_a",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.6,
          "reason": "Method `create_team_from_single_users` contains a call chain of length 3.",
          "location": {
            "line": 150
          },
          "context": "def self.create_team_from_single_users(min_team_size, parent, team_type, users)\n    num_of_teams = users.length.fdiv(min_team_size).ceil\n    next_team_member_index = 0\n    (1..num_of_teams).to_a.each do |i|\n      team = Object.const_get(team_type + 'Team').create(name: 'Team_' + i.to_s, parent_id: parent.id)\n      TeamNode.create(parent_id: parent.id, node_object_id: team.id)",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.6,
          "reason": "Method `generate_team_name` contains a call chain of length 3.",
          "location": {
            "line": 182
          },
          "context": "def self.generate_team_name(_team_name_prefix = '')\n    last_team = Team.where('name LIKE ?', \"#{_team_name_prefix} Team_%\")\n                  .order(\"CAST(SUBSTRING(name, LENGTH('#{_team_name_prefix} Team_') + 1) AS UNSIGNED) DESC\")\n                  .first\n    counter = last_team ? last_team.name.scan(/\\d+/).first.to_i + 1 : 1\n    team_name = \"#{_team_name_prefix} Team_#{counter}\"",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.7,
          "reason": "Method `copy_content` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 27
          },
          "context": "def self.copy_content(source, destination)\n    source.each do |each_element|\n      each_element.copy(destination.id)\n    end\n  end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.75,
          "reason": "Method `add_member` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 80
          },
          "context": "def add_member(user, _assignment_id = nil)\n    raise \"The user #{user.name} is already a member of the team #{name}\" if user?(user)\n\n    can_add_member = false\n    unless full?\n      can_add_member = true",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.7,
          "reason": "Method `size` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 96
          },
          "context": "def self.size(team_id)\n    #TeamsParticipant.where(team_id: team_id).count\n    count = 0\n    members = TeamsParticipant.where(team_id: team_id)\n    members.each do |member|\n      member_name = member.name",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.75,
          "reason": "Method `copy_members` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 110
          },
          "context": "def copy_members(new_team)\n    members = TeamsParticipant.where(team_id: id)\n    members.each do |member|\n      t_user = TeamsParticipant.create(team_id: new_team.id, user_id: member.user_id)\n      parent = Object.const_get(parent_model).find(parent_id)\n      TeamUserNode.create(parent_id: parent.id, node_object_id: t_user.id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.65,
          "reason": "Method `check_for_existing` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 120
          },
          "context": "def self.check_for_existing(parent, name, team_type)\n    list = Object.const_get(team_type + 'Team').where(parent_id: parent.id, name: name)\n    raise TeamExistsError, \"The team name #{name} is already in use.\" unless list.empty?\n  end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Method `randomize_all_by_parent` manipulates external state 19 times vs 0 local accesses.",
          "location": {
            "line": 128
          },
          "context": "def self.randomize_all_by_parent(parent, team_type, min_team_size)\n    participants = Participant.where(parent_id: parent.id, type: parent.class.to_s + 'Participant', can_mentor: [false, nil])\n    participants = participants.sort { rand(-1..1) }\n    users = participants.map { |p| User.find(p.user_id) }.to_a\n    # find teams still need team members and users who are not in any team\n    teams = Team.where(parent_id: parent.id, type: parent.class.to_s + 'Team').to_a",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Method `create_team_from_single_users` manipulates external state 11 times vs 0 local accesses.",
          "location": {
            "line": 150
          },
          "context": "def self.create_team_from_single_users(min_team_size, parent, team_type, users)\n    num_of_teams = users.length.fdiv(min_team_size).ceil\n    next_team_member_index = 0\n    (1..num_of_teams).to_a.each do |i|\n      team = Object.const_get(team_type + 'Team').create(name: 'Team_' + i.to_s, parent_id: parent.id)\n      TeamNode.create(parent_id: parent.id, node_object_id: team.id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Method `assign_single_users_to_teams` manipulates external state 10 times vs 0 local accesses.",
          "location": {
            "line": 167
          },
          "context": "def self.assign_single_users_to_teams(min_team_size, parent, teams, users)\n    teams.each do |team|\n      curr_team_size = Team.size(team.id)\n      member_num_difference = min_team_size - curr_team_size\n      while member_num_difference > 0\n        team.add_member(users.first, parent.id)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.65,
          "reason": "Method `generate_team_name` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 182
          },
          "context": "def self.generate_team_name(_team_name_prefix = '')\n    last_team = Team.where('name LIKE ?', \"#{_team_name_prefix} Team_%\")\n                  .order(\"CAST(SUBSTRING(name, LENGTH('#{_team_name_prefix} Team_') + 1) AS UNSIGNED) DESC\")\n                  .first\n    counter = last_team ? last_team.name.scan(/\\d+/).first.to_i + 1 : 1\n    team_name = \"#{_team_name_prefix} Team_#{counter}\"",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.65,
          "reason": "Method `import_team_members` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 192
          },
          "context": "def import_team_members(row_hash)\n    row_hash[:teammembers].each_with_index do |teammate, _index|\n      user = User.find_by(name: teammate.to_s)\n      if user.nil?\n        raise ImportError, \"The user '#{teammate}' was not found. <a href='/users/new'>Create</a> this user?\"\n      else",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.85,
          "reason": "Method `import` manipulates external state 7 times vs 0 local accesses.",
          "location": {
            "line": 204
          },
          "context": "def self.import(row_hash, id, options, teamtype)\n    raise ArgumentError, 'Not enough fields on this line.' if row_hash.empty? || (row_hash[:teammembers].empty? && (options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last')) || (row_hash[:teammembers].empty? && (options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last'))\n    if options[:has_teamname] == 'true_first' || options[:has_teamname] == 'true_last'\n      name = row_hash[:teamname].to_s\n      team = where(['name =? && parent_id =?', name, id]).first\n      team_exists = !team.nil?",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.75,
          "reason": "Method `handle_duplicate` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 228
          },
          "context": "def self.handle_duplicate(team, name, id, handle_dups, teamtype)\n    return name if team.nil? # no duplicate\n    return nil if handle_dups == 'ignore' # ignore: do not create the new team\n\n    if handle_dups == 'rename' # rename: rename new team\n      if teamtype.is_a?(CourseTeam)",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Method `export` manipulates external state 10 times vs 0 local accesses.",
          "location": {
            "line": 248
          },
          "context": "def self.export(csv, parent_id, options, teamtype)\n    if teamtype.is_a?(CourseTeam)\n      teams = CourseTeam.where(parent_id: parent_id)\n    elsif teamtype.is_a?(AssignmentTeam)\n      teams = AssignmentTeam.where(parent_id: parent_id)\n    end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.7,
          "reason": "Method `create_team_and_node` manipulates external state 4 times vs 0 local accesses.",
          "location": {
            "line": 269
          },
          "context": "def self.create_team_and_node(id)\n    parent = parent_model id # current_task will be either a course object or an assignment object.\n    team_name = Team.generate_team_name(parent.name)\n    team = create(name: team_name, parent_id: id)\n    # new teamnode will have current_task.id as parent_id and team_id as node_object_id.\n    TeamNode.create(parent_id: id, node_object_id: team.id)",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": false,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.65,
          "reason": "Method `create_team_with_users` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 294
          },
          "context": "def self.create_team_with_users(parent_id, user_ids)\n    team = create_team_and_node(parent_id)\n\n    user_ids.each do |user_id|\n      remove_user_from_previous_team(parent_id, user_id)",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.65,
          "reason": "Method `remove_user_from_previous_team` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 307
          },
          "context": "def self.remove_user_from_previous_team(parent_id, user_id)\n    team_participant = TeamsParticipant.where(user_id: user_id).find { |team_participant_obj| team_participant_obj.team.parent_id == parent_id }\n    begin\n      team_participant.destroy\n    rescue StandardError\n      nil",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 0.8,
          "reason": "Method `find_team_participants` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 316
          },
          "context": "def self.find_team_participants(assignment_id, user_id)\n    TeamsParticipant.joins('INNER JOIN teams ON teams_participants.team_id = teams.id')\n             .select('teams.id as t_id')\n             .where('teams.parent_id = ? and teams_participants.user_id = ?', assignment_id, user_id)\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team.rb",
          "class": "Team",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class Team < ApplicationRecord\n  has_many :teams_participants, dependent: :destroy\n  has_many :users, through: :teams_participants\n  has_many :join_team_requests, dependent: :destroy\n  has_one :team_node, foreign_key: :node_object_id, dependent: :destroy\n  has_many :signed_up_teams, dependent: :destroy\n  has_many :bids, dependent: :destroy\n  has_paper_trail",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 19,
            "lines_deleted": 19,
            "methods_added": [
              "self"
            ],
            "methods_removed": [
              "self"
            ]
          }
        }
      ]
    },
    {
      "filename": "app/models/team_user_node.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
          "class": "TeamUserNode",
          "score": 1.0,
          "reason": "Class exposes 4 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class TeamUserNode < Node\n  belongs_to :node_object, class_name: 'TeamsParticipant'\n  # attr_accessible :parent_id, :node_object_id  # unnecessary protected attributes\n\n  def self.table\n    'teams_participants'\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
          "class": "TeamUserNode",
          "score": 0.8,
          "reason": "Method `get` manipulates external state 6 times vs 0 local accesses.",
          "location": {
            "line": 13
          },
          "context": "def self.get(parent_id)\n    nodes = Node.joins('INNER JOIN teams_participants ON nodes.node_object_id = teams_participants.id')\n                .select('nodes.*')\n                .where(\"nodes.type = 'TeamUserNode'\")\n    nodes.where('teams_participants.team_id = ?', parent_id) if parent_id\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_team_user_node.rb",
          "class": "TeamUserNode",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class TeamUserNode < Node\n  belongs_to :node_object, class_name: 'TeamsParticipant'\n  # attr_accessible :parent_id, :node_object_id  # unnecessary protected attributes\n\n  def self.table\n    'teams_participants'\n  end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/teams_participant.rb",
      "status": "added",
      "diff_summary": "72 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 72,
        "lines_deleted": 0
      },
      "violations_count": 9,
      "violations": [
        {
          "type": "SRP",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 1.0,
          "reason": "Class exposes 8 methods (limit: 4).",
          "location": {
            "line": 1
          },
          "context": "class TeamsParticipant < ApplicationRecord\n  belongs_to :team\n  belongs_to :participant\n\n  # paper_trail, node, etc\n  has_one    :team_participant_node,\n             foreign_key: 'node_object_id',\n             dependent:   :destroy",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `delete` contains a call chain of length 3.",
          "location": {
            "line": 25
          },
          "context": "def delete\n    team_participant_node&.destroy\n    t = team\n    destroy\n    t.destroy if t.teams_participants.empty?\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `team_id` contains a call chain of length 3.",
          "location": {
            "line": 69
          },
          "context": "def self.team_id(assignment_id, user_id)\n    each_for(user_id).find { |tp| tp.team.parent_id == assignment_id }&.team_id\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `delete` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 25
          },
          "context": "def delete\n    team_participant_node&.destroy\n    t = team\n    destroy\n    t.destroy if t.teams_participants.empty?\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `remove_team` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 33
          },
          "context": "def self.remove_team(user_id, team_id)\n    jp = joins(participant: :user)\n           .where('participants.user_id = ? AND team_id = ?', user_id, team_id)\n           .first\n    jp&.destroy\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.65,
          "reason": "Method `add_member_to_invited_team` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 51
          },
          "context": "def self.add_member_to_invited_team(invitee_user_id, invited_user_id, assignment_id)\n    success = false\n    each_for(invitee_user_id) do |tp|\n      next unless (asg_team = AssignmentTeam.find_by(id: tp.team_id, parent_id: assignment_id))\n      invited_participant = Participant.find_by(user_id: invited_user_id, parent_id: assignment_id)\n      success = asg_team.add_member(invited_participant) if invited_participant",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `each_for` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 62
          },
          "context": "def self.each_for(user_id, &block)\n    joins(participant: :user)\n      .where('participants.user_id = ?', user_id)\n      .each(&block)\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 0.6,
          "reason": "Method `team_id` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 69
          },
          "context": "def self.team_id(assignment_id, user_id)\n    each_for(user_id).find { |tp| tp.team.parent_id == assignment_id }&.team_id\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        },
        {
          "type": "ENCAPSULATION",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/app_models_teams_participant.rb",
          "class": "TeamsParticipant",
          "score": 1.0,
          "reason": "Has 100.0% public methods (limit: 60.0%).",
          "location": {
            "line": 1
          },
          "context": "class TeamsParticipant < ApplicationRecord\n  belongs_to :team\n  belongs_to :participant\n\n  # paper_trail, node, etc\n  has_one    :team_participant_node,\n             foreign_key: 'node_object_id',\n             dependent:   :destroy",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 72,
            "lines_deleted": 0,
            "methods_added": [
              "name",
              "delete",
              "self",
              "self",
              "self",
              "self",
              "self",
              "self"
            ],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "app/models/teams_user.rb",
      "status": "removed",
      "diff_summary": "0 addition(s), 76 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 0,
        "lines_deleted": 76
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "app/models/user.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "config/routes.rb",
      "status": "modified",
      "diff_summary": "114 addition(s), 116 deletion(s) in 14 hunk(s)",
      "changes_analysis": {
        "lines_added": 114,
        "lines_deleted": 116
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/002_initialize_custom.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/019_create_teams_users.rb",
      "status": "modified",
      "diff_summary": "7 addition(s), 7 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 7,
        "lines_deleted": 7
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_019_create_teams_users.rb",
          "class": "CreateTeamsUsers",
          "score": 0.65,
          "reason": "Method `up` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 2
          },
          "context": "def self.up\n    create_table 'teams_participants', force: true do |t|\n      t.column 'team_id', :integer\n      t.column 'user_id', :integer\n    end",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_019_create_teams_users.rb",
          "class": "CreateTeamsUsers",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class CreateTeamsUsers < ActiveRecord::Migration[4.2]\n  def self.up\n    create_table 'teams_participants', force: true do |t|\n      t.column 'team_id', :integer\n      t.column 'user_id', :integer\n    end\n\n    add_index 'teams_participants', ['team_id'], name: 'fk_users_teams'",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 7,
            "lines_deleted": 7,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/066_create_team_user_nodes.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 3,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
          "class": "CreateTeamUserNodes",
          "score": 0.75,
          "reason": "Method `up` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 2
          },
          "context": "def self.up\n    begin\n      remove_column :teams_participants, :assignment_id\n    rescue StandardError\n    end",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
          "class": "CreateTeamUserNodes",
          "score": 0.6,
          "reason": "Method `down` manipulates external state 2 times vs 0 local accesses.",
          "location": {
            "line": 17
          },
          "context": "def self.down\n    teamsusers = TeamsUser.all\n    teamsusers.each(&:destroy)\n\n    add_column :teams_participants, :assignment_id, :integer\n  end",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_066_create_team_user_nodes.rb",
          "class": "CreateTeamUserNodes",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class CreateTeamUserNodes < ActiveRecord::Migration[4.2]\n  def self.up\n    begin\n      remove_column :teams_participants, :assignment_id\n    rescue StandardError\n    end\n\n    teamsusers = TeamsUser.all",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20121018001330_change_teams_users_to_teams_participants.rb",
      "status": "removed",
      "diff_summary": "0 addition(s), 8 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 0,
        "lines_deleted": 8
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20131103014327_create_participant_score_views.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20131103014327_create_participant_score_views.rb",
          "class": "CreateParticipantScoreViews",
          "score": 1.0,
          "reason": "Method `up` manipulates external state 20 times vs 0 local accesses.",
          "location": {
            "line": 2
          },
          "context": "def self.up\n    execute <<-SQL\n      CREATE VIEW participant_score_views AS SELECT r.id response_id,s.answer,q.weight,qs.name questionaire_type,qs.max_question_score,t.id as team_id,user_id as participant_id , t.parent_id as assignment_id\n FROM answers s ,responses r, response_maps rm, questions q, questionnaires qs , teams_participants tu , teams t\n WHERE  rm.id = r.map_id AND r.id=s.response_id AND q.id = s.question_id AND qs.id = q.questionnaire_id    AND tu.team_id = rm.reviewee_id   AND tu.team_id = t.id\n    SQL",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20131103014327_create_participant_score_views.rb",
          "class": "CreateParticipantScoreViews",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class CreateParticipantScoreViews < ActiveRecord::Migration[4.2]\n  def self.up\n    execute <<-SQL\n      CREATE VIEW participant_score_views AS SELECT r.id response_id,s.answer,q.weight,qs.name questionaire_type,qs.max_question_score,t.id as team_id,user_id as participant_id , t.parent_id as assignment_id\n FROM answers s ,responses r, response_maps rm, questions q, questionnaires qs , teams_participants tu , teams t\n WHERE  rm.id = r.map_id AND r.id=s.response_id AND q.id = s.question_id AND qs.id = q.questionnaire_id    AND tu.team_id = rm.reviewee_id   AND tu.team_id = t.id\n    SQL\n  end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 1,
            "lines_deleted": 1,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20141111010259_add_index_to_response_maps.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20141111010259_add_index_to_response_maps.rb",
          "class": "AddIndexToResponseMaps",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class AddIndexToResponseMaps < ActiveRecord::Migration[4.2]\n  def self.up\n    # add_index :response_maps, :reviewee_id\n    # add_index :response_maps, :reviewer_id\n    # add_index :response_maps, :reviewed_object_id\n\n    # add_index :teams_participants, :user_id",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20141204022200_add_team_index_to_teams_users.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20141204022200_add_team_index_to_teams_users.rb",
          "class": "AddTeamIndexToTeamsUsers",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class AddTeamIndexToTeamsUsers < ActiveRecord::Migration[4.2]\n   def self.up\n      #add_index :teams_participants, :team_id\n   end\n\n  def self.down\n    # remove_index :teams_participants, :team_id\n  end",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 2,
            "lines_deleted": 2,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20150527105416_convert_all_individual_assignments_to_one_member_team_assignments.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20211110161054_add_duty_id_to_teams_users.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20220405141744_add_pair_programming_status_to_teams_users.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20230415194444_add_participant_id_and_populate.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "LAW_OF_DEMETER",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20230415194444_add_participant_id_and_populate.rb",
          "class": "AddParticipantIdAndPopulate",
          "score": 0.6,
          "reason": "Method `up` contains a call chain of length 3.",
          "location": {
            "line": 3
          },
          "context": "def up\n    add_column :teams_participants, :participant_id, :integer, limit: 4, index: true\n    add_foreign_key :teams_participants, :participants\n    # firstly, fetch all TeamsUser rows\n    teams_participants = TeamsUser.all\n    # for each TeamsUser row",
          "confidence": 0.8,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20230415194444_add_participant_id_and_populate.rb",
          "class": "AddParticipantIdAndPopulate",
          "score": 0.95,
          "reason": "Method `up` manipulates external state 9 times vs 0 local accesses.",
          "location": {
            "line": 3
          },
          "context": "def up\n    add_column :teams_participants, :participant_id, :integer, limit: 4, index: true\n    add_foreign_key :teams_participants, :participants\n    # firstly, fetch all TeamsUser rows\n    teams_participants = TeamsUser.all\n    # for each TeamsUser row",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 6,
            "lines_deleted": 6,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20240319000001_rename_teams_users_to_teams_participants.rb",
      "status": "added",
      "diff_summary": "15 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 15,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20240320000002_add_participant_id_to_teams_participants.rb",
      "status": "added",
      "diff_summary": "28 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 28,
        "lines_deleted": 0
      },
      "violations_count": 1,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_20240320000002_add_participant_id_to_teams_participants.rb",
          "class": "AddParticipantIdToTeamsParticipants",
          "score": 0.75,
          "reason": "Method `up` manipulates external state 5 times vs 0 local accesses.",
          "location": {
            "line": 5
          },
          "context": "def up\n      unless column_exists?(:teams_participants, :participant_id)\n        add_column :teams_participants, :participant_id, :integer\n        add_index  :teams_participants, :participant_id, algorithm: :concurrently\n  \n        # backfill: for each row, find the Participant whose user_id = old user_id",
          "confidence": 0.95,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": true,
          "diff_context": {
            "lines_added": 28,
            "lines_deleted": 0,
            "methods_added": [
              "up",
              "down"
            ],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/migrate/20240320000003_remove_user_id_from_teams_participants.rb",
      "status": "added",
      "diff_summary": "18 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 18,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate/20240320000004_add_fks_to_teams_participants.rb",
      "status": "added",
      "diff_summary": "8 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 8,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "db/migrate_save/020_teams_users.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 2,
      "violations": [
        {
          "type": "INFORMATION_EXPERT",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_save_020_teams_users.rb",
          "class": "TeamsUsers",
          "score": 0.65,
          "reason": "Method `up` manipulates external state 3 times vs 0 local accesses.",
          "location": {
            "line": 2
          },
          "context": "def self.up\n    create_table :teams_participants do |t| # maps users to teams; in rare cases, a single individual is on > 1 team for an assgt.\n      t.column :team_id, :integer\n      t.column :user_id, :integer\n    end\n    execute \"alter table teams_participants",
          "confidence": 0.85,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [],
            "methods_removed": []
          }
        },
        {
          "type": "OVERUSE_CLASS_METHODS",
          "file": "/Users/aarya.rajoju/CODE/temp/ruby-code-parser-work/temp_downloads/db_migrate_save_020_teams_users.rb",
          "class": "TeamsUsers",
          "score": 0.7,
          "reason": "Defines 2 class methods and 0 instance method(s); consider instance state.",
          "location": {
            "line": 1
          },
          "context": "class TeamsUsers < ActiveRecord::Migration[4.2]\n  def self.up\n    create_table :teams_participants do |t| # maps users to teams; in rare cases, a single individual is on > 1 team for an assgt.\n      t.column :team_id, :integer\n      t.column :user_id, :integer\n    end\n    execute \"alter table teams_participants\n             add constraint fk_users_teams",
          "confidence": 0.9,
          "justification": "Heuristic fallback confirmation based on strong static signals.",
          "suggestion": "Extract collaborators and follow the cited principle.",
          "in_changed_code": true,
          "near_changed_line": true,
          "in_modified_method": false,
          "diff_context": {
            "lines_added": 5,
            "lines_deleted": 5,
            "methods_added": [],
            "methods_removed": []
          }
        }
      ]
    },
    {
      "filename": "db/schema.rb",
      "status": "modified",
      "diff_summary": "10 addition(s), 11 deletion(s) in 3 hunk(s)",
      "changes_analysis": {
        "lines_added": 10,
        "lines_deleted": 11
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/advertise_for_partner_controller_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/invitations_controller_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/lottery_controller_spec.rb",
      "status": "modified",
      "diff_summary": "12 addition(s), 12 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 12,
        "lines_deleted": 12
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/pair_programming_controller_spec.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 4 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/popup_controller_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/review_mapping_controller_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/sign_up_sheet_controller_spec.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 5 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/student_teams_controller_spec.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/teams_participants_controller_spec.rb",
      "status": "added",
      "diff_summary": "179 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 179,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/controllers/teams_users_controller_spec.rb",
      "status": "removed",
      "diff_summary": "0 addition(s), 340 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 0,
        "lines_deleted": 340
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/factories/factories.rb",
      "status": "modified",
      "diff_summary": "504 addition(s), 510 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 504,
        "lines_deleted": 510
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/airbrake_exception_errors_feature_tests_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/assignment_team_member_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/bookmark_review_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/instructor_do_review_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/list_teams_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/peer_review_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/quiz_spec.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 4 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/review_mapping_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/teams_as_reviewers_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/features/view_team_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/helpers/review_mapping_helper_spec.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 4 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/assignment_participant_spec.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/assignment_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/assignment_team_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 2 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/cake_spec.rb",
      "status": "modified",
      "diff_summary": "4 addition(s), 4 deletion(s) in 3 hunk(s)",
      "changes_analysis": {
        "lines_added": 4,
        "lines_deleted": 4
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/course_team_spec.rb",
      "status": "modified",
      "diff_summary": "3 addition(s), 3 deletion(s) in 3 hunk(s)",
      "changes_analysis": {
        "lines_added": 3,
        "lines_deleted": 3
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/duty_spec.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/invitation_spec.rb",
      "status": "modified",
      "diff_summary": "19 addition(s), 19 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 19,
        "lines_deleted": 19
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/mentor_management_spec.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 6 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/participant_spec.rb",
      "status": "modified",
      "diff_summary": "6 addition(s), 6 deletion(s) in 4 hunk(s)",
      "changes_analysis": {
        "lines_added": 6,
        "lines_deleted": 6
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/review_response_map_spec.rb",
      "status": "modified",
      "diff_summary": "2 addition(s), 2 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 2,
        "lines_deleted": 2
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/student_task_spec.rb",
      "status": "modified",
      "diff_summary": "5 addition(s), 5 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 5,
        "lines_deleted": 5
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/tag_prompt_deployment_spec.rb",
      "status": "modified",
      "diff_summary": "9 addition(s), 9 deletion(s) in 6 hunk(s)",
      "changes_analysis": {
        "lines_added": 9,
        "lines_deleted": 9
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/team_spec.rb",
      "status": "modified",
      "diff_summary": "8 addition(s), 8 deletion(s) in 5 hunk(s)",
      "changes_analysis": {
        "lines_added": 8,
        "lines_deleted": 8
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/models/teams_participant_spec.rb",
      "status": "added",
      "diff_summary": "132 addition(s), 0 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 132,
        "lines_deleted": 0
      },
      "violations_count": 0,
      "violations": []
    },
    {
      "filename": "spec/support/teams_shared.rb",
      "status": "modified",
      "diff_summary": "1 addition(s), 1 deletion(s) in 1 hunk(s)",
      "changes_analysis": {
        "lines_added": 1,
        "lines_deleted": 1
      },
      "violations_count": 0,
      "violations": []
    }
  ],
  "metadata": {
    "analyzed_at": "2026-01-22T12:57:27-05:00",
    "analyzer_version": "1.0.0",
    "config": {
      "min_confidence": 0.6
    }
  }
}